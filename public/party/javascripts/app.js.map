{"version":3,"sources":["app/application.coffee","app/controllers/game_controller.coffee","app/initialize.coffee","app/lib/actions.coffee","app/lib/activist.coffee","app/lib/admin.coffee","app/lib/autopilot.coffee","app/lib/chatterbox.coffee","app/lib/escort.coffee","app/lib/event_broker.coffee","app/lib/landscape.coffee","app/lib/landscaper.coffee","app/lib/mediator.coffee","app/lib/navi.coffee","app/lib/reactor.coffee","app/lib/utils.coffee","app/lib/weather.coffee","app/models/chat_message.coffee","app/models/collection.coffee","app/models/hint.coffee","app/models/model.coffee","app/models/notifier.coffee","app/models/player.coffee","app/models/players.coffee","app/models/trailblazer.coffee","app/views/avatar.coffee","app/views/chat_input_view.coffee","app/views/collection_view.coffee","app/views/dj_view.coffee","app/views/drawing_canvas.coffee","app/views/edit_avatar_view.coffee","app/views/hint_view.coffee","app/views/intro_view.coffee","app/views/join_game_view.coffee","app/views/map_view.coffee","app/views/modal_view.coffee","app/views/player_list.coffee","app/views/speech_bubble_view.coffee","app/views/templates/avatar.jade","app/views/templates/avatar_head.jade","app/views/templates/bathroom_photo.jade","app/views/templates/chat_input.jade","app/views/templates/hint.jade","app/views/templates/intro.jade","app/views/templates/join_game.jade","app/views/templates/kick.jade","app/views/templates/map.jade","app/views/templates/modal.jade","app/views/templates/speech_bubble.jade","app/views/templates/team_photo.jade","app/views/view.coffee"],"names":[],"mappings":"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W;;AACX,CADA,EACW,KAAX,mBAAW;;AAEX,CAHA,EAGuB,GAAjB,CAAN;CACE;;;;;CAAA;;CAAA,EAAW,MAAX;;CAAA,EACU,KAAV;;CADA,EAGY,MAAC,CAAb;CACE;CAAA,EACc,CAAd,GAAqB,GAArB;CACC,EAAa,CAAb,EAAD,CAAqB,IAArB;CANF,EAGY;;CAHZ,EAQQ,GAAR,GAAQ;CACN;CAAA;CACA,IAAgB,CAAN,SAAP;CACD,CAAG,CAAmD,CAArD,EAAD,GAAuD,IAAvD;CACE;CAAA,OACA;CACC,GAAD,CAAC,KAAU,GAAX;CAHF,MAAsD;CAIrD,CAAE,CAAwD,CAA1D,IAAD,CAA4D,GAA5D;CACE;CAAA,OACA;CACC,GAAD,CAAC,KAAU,GAAX;CAHF,MAA2D;MAL7D;CAUG,CAAE,EAAF,IAAe,GAAhB;KAZI;CARR,EAQQ;;CARR;;CAD8C;;;CCHhD;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAdA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAdA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAdA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAdA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAdA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAdA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA1KA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAdA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAdA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAdA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAdA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAdA;AAAA;;ACAA;GAAA;;wJAAA;;AAAA,GAAc,KAAd,MAAc;;AACd,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","file":"public/javascripts/app.js","sourcesContent":["GameController = require 'controllers/game_controller'\nmediator       = require 'lib/mediator'\n\n# The application bootstrapper.\nApplication =\n  initialize: ->    \n    @gameController = new GameController()\n\n    # Freeze the object\n    Object.freeze? this\n\nmodule.exports = Application\n","MapView        = require 'views/map_view'\nDJView         = require 'views/dj_view'\nmediator       = require 'lib/mediator'\nEventBroker    = require 'lib/event_broker'\nPlayer         = require 'models/player'\nPlayers        = require 'models/players'\nPlayerList     = require 'views/player_list'\nAvatar         = require 'views/avatar'\nDrawingCanvas  = require 'views/drawing_canvas'\nIntroView      = require 'views/intro_view'\nTrailblazer    = require 'models/trailblazer'\nWeather        = require 'lib/weather'\nNotifier       = require 'models/notifier'\nJoinGameView   = require 'views/join_game_view'\nEditAvatarView = require 'views/edit_avatar_view'\nAutoPilot      = require 'lib/autopilot'\nNavi           = require 'lib/navi'\nReactor        = require 'lib/reactor'\nAdmin          = require 'lib/admin'\nutils          = require 'lib/utils'\n\nmodule.exports = class GameController\n  Backbone.utils.extend @prototype, EventBroker\n  players: []\n  multiplayer: true\n  snow: false\n  trails: false\n  customNames: true\n  clickToNavigate: false\n\n  constructor: ->\n    @players = new Players []\n    @notifier = new Notifier\n    @setupDJ()\n    @setupMap()\n    @setupCanvas()\n    @setupPlayer()\n    @setupSidebar()\n    @admin = new Admin\n\n    @subscribeEvent 'addPlayer', @addPlayer\n    @subscribeEvent 'triggerIntro', @intro\n    @subscribeEvent 'togglePlayback', ->\n      @DJ.togglePlayback()\n    @createPlayerList()\n    mediator.game_state = 'playing'\n\n  setupMap: ->\n    @mapView = new MapView\n      className: 'map'\n      el: document.getElementById(\"map\")\n      autoRender: true\n    @mapView.DJ = @DJ\n    mediator = mediator\n\n    @reactor = new Reactor(@mapView, @players)\n    @nav     = new Navi(@mapView)\n\n    Weather.snow('snowCanvas') if @snow\n\n  setupDJ: ->\n    @DJ = new DJView\n\n  setupCanvas: ->\n    @canvas = new DrawingCanvas\n      el: document.getElementById('drawCanvas')\n      autoRender: true\n\n  setupPlayer: ->\n    attrs = JSON.parse(localStorage.getItem(\"CremalabPartyAvatar\"))\n    mediator.current_player = new Player(attrs)\n    mediator.current_player.set\n      orientation: 1\n      x_position: 968\n      y_position: 1384\n      active: true\n      id: Date.now()\n\n    view = @intro()\n    @mapView.listenTo view, 'dispose', => \n      @drawOrPromptAvatar()\n    if @multiplayer\n      @notifier.connect mediator.current_player, (channel) =>\n        channel = channel.split(\"players_\")[1]\n        @mapView.setDimensions()\n\n  drawOrPromptAvatar: ->\n    if mediator.current_player.get('name')\n      return @createPlayerAvatar(mediator.current_player)\n    else\n      if @customNames\n        @promptPlayerName()\n      else\n        @createPlayerAvatar(mediator.current_player)\n\n  promptPlayerName: (editing) ->\n    player = mediator.current_player\n    if editing\n      view = new EditAvatarView\n        container: document.body\n        model: player\n    else\n      view = new JoinGameView\n        container: document.body\n        model: player\n\n    mediator.current_player.listenTo view, 'setPlayerName', (name) =>\n      view.dispose()\n      player.set('name', name)\n      player.save()\n      @createPlayerAvatar(player) unless editing\n\n\n  createPlayerAvatar: (player) ->\n    avatar = new Avatar\n      model: player\n    avatar.autopilot = new AutoPilot(avatar, @mapView)\n\n    if @trails\n      avatar.trailblazer = new Trailblazer\n        player: player\n        avatar: avatar\n        canvas: @canvas\n\n    @mapView.listenTo avatar, 'playerMove', @mapView.checkPlayerPosition\n\n    @mapView.spawnPlayer(player, avatar)\n    @players.add player, {at: 0}\n    @mapView.addTouchEvents(avatar, 'touchstart')\n\n    if @clickToNavigate\n      @mapView.addTouchEvents(avatar, 'click')\n    @setupGameMenu()\n    @mapView.centerMapOn(player.get('x_position'), player.get('y_position'), 0, 20)\n\n  addPlayer: (uuid, data) ->\n    if data\n      unless parseFloat(uuid) is parseFloat(mediator.current_player.id)\n        unless @players.get(uuid)\n          player = new Player({id: uuid})\n          player.set(data)\n          avatar = new Avatar\n            model: player\n\n          if @trails\n            avatar.trailblazer = new Trailblazer\n              player: player\n              avatar: avatar\n              canvas: @canvas\n\n          @mapView.listenTo avatar, 'playerMove', @mapView.checkPlayerPosition\n          @mapView.spawnPlayer(player, avatar)\n          @players.add player\n\n  createPlayerList: ->\n    @playerList = new PlayerList\n      collection: @players\n      autoRender: true\n      container: document.getElementById('player_list')\n      map: @mapView\n\n  setupGameMenu: ->\n    editAvatarButton = document.createElement(\"button\")\n    document.getElementById('game-settings').appendChild(editAvatarButton)\n    editAvatarButton.innerHTML = \"Edit\"\n    editAvatarButton.addEventListener 'click', (e) =>\n      e.preventDefault()\n      @promptPlayerName(true)\n\n  intro: (triggerVolume) ->\n    view = new IntroView\n      container: document.body\n      triggerVolume: triggerVolume\n    return view\n\n  setupSidebar: ->\n    logo = document.querySelector('.sidebar-brand')\n    logo.addEventListener 'click', =>\n      @publishEvent('triggerIntro', false)\n\n    audioToggle = document.querySelector('.audioToggle')\n    audioToggle.addEventListener 'click', =>\n      @publishEvent('togglePlayback')\n      audioToggle.classList.toggle('sub-muted')\n\n","application = require 'application'\n\ndocument.addEventListener \"DOMContentLoaded\", ->\n  application.initialize()","Modal       = require 'views/modal_view'\nmediator    = require 'lib/mediator'\nEventBroker = require 'lib/event_broker'\n\nmodule.exports =\n  team_photo: (map) ->\n    unless mediator.game_state is 'modal'\n      view = new Modal\n        container: document.body\n        className: 'modal'\n        template: require 'views/templates/team_photo'\n        autoRender: true\n      mediator.game_state = 'modal'\n  bathroom_photo: (map) ->\n    unless mediator.game_state is 'modal'\n      view = new Modal\n        container: document.body\n        className: 'modal'\n        template: require 'views/templates/bathroom_photo'\n        autoRender: true\n    if @audio.paused\n      mediator.game_state = 'modal'\n  lamp_light: (map, options) ->\n    item= options[0]\n    if item.img\n      if item.lamp_on\n        item.img.setAttribute('src', 'party/images/lamp_1.png')\n        item.lamp_on = false\n      else\n        item.img.setAttribute('src', 'party/images/lamp_2.png')\n        item.lamp_on = true\n  lamp_light_flip: (map, options) ->\n    item= options[0]\n    if item.img\n      if item.lamp_on\n        item.img.setAttribute('src', 'party/images/lamp_1_flip.png')\n        item.lamp_on = false\n      else\n        item.img.setAttribute('src', 'party/images/lamp_2_flip.png')\n        item.lamp_on = true\n  tweet_friends: (map, options) ->\n    window.open options[0], \"twitter\"\n\n  disco: (map) ->\n    classList = map.el.classList\n    if classList.contains('disco-time')\n      classList.remove 'disco-time'\n      map.DJ.playTrack('soundtrack')\n    else\n      classList.add 'disco-time'\n      map.DJ.playTrack('disco')\n","EventBroker = require 'lib/event_broker'\n\nmodule.exports = class Activist\n  Backbone.utils.extend @prototype, EventBroker\n  actionKey: 32\n  actionableItems: []\n  constructor: (landscaper) ->\n    @landscaper = landscaper\n    document.addEventListener 'keydown', @handleKeyDown\n    @subscribeEvent 'map:interact', @handleTap\n  activate: (ob) ->\n    ob.onHit = ob.onHit or {}\n    ob.events = {}\n    ob.addEventListener = (eventName, handler) ->\n      @events[eventName] = [] if !@events[eventName]\n      @events[eventName].push handler\n      return\n\n    ob.raiseEvent = (eventName, args) ->\n      currentEvents = @events[eventName]\n      return  unless currentEvents\n      i = 0\n\n      while i < currentEvents.length\n        currentEvents[i] args  if typeof currentEvents[i] is \"function\"\n        i++\n      return\n    @addActor(ob)\n    return ob\n\n  addActor: (item) ->\n\n    item.addEventListener 'hit_left', (options) ->\n      item.onHit.left(item, options) if item.onHit.left\n    item.addEventListener 'hit_right', (options) ->\n      item.onHit.right(item, options) if item.onHit.right\n    item.addEventListener 'hit_top', (options) ->\n      item.onHit.top(item, options) if item.onHit.top\n    item.addEventListener 'hit_bottom', (options) ->\n      item.onHit.bottom(item, options) if item.onHit.bottom\n    item.addEventListener 'hit_any', (options) ->\n      item.onHit.any(item, options) if item.onHit.any\n    item.addEventListener 'enterProximity', (options) ->\n      item.current_player_within_proximity = true\n      item.proximity.onEnter(item, options) if item.proximity\n    item.addEventListener 'leaveProximity', (options) ->\n      item.current_player_within_proximity = false\n      item.proximity.onLeave(item, options) if item.proximity\n    if item.proximity and item.proximity.keys\n      if item.proximity.keys.hasOwnProperty('action')\n        @actionableItems.push item\n        console.log item.id\n\n  handleKeyDown: (e) =>\n    switch e.keyCode\n      when 32\n        @fireActionHandlers()\n\n  handleTap: (e, x, y) ->\n    for item in @actionableItems\n      if item.current_player_within_proximity\n        av_proxy = \n          width: 10\n          height: 10\n        if @landscaper.avatarOverlaps(av_proxy, item, x - @landscaper.map.offset_x, y - @landscaper.map.offset_y)\n          e.preventDefault()\n          e.stopPropagation()\n          item.proximity.keys.action(item)\n\n  fireActionHandlers: ->\n    for item in @actionableItems\n      if item.current_player_within_proximity\n        item.proximity.keys.action(item)\n\n\n","mediator    = require 'lib/mediator'\nEventBroker = require 'lib/event_broker'\n\nmodule.exports = class Admin\n  Backbone.utils.extend @prototype, EventBroker\n  constructor: ->\n    @subscribeEvent \"admin:init\", @init\n\n  init: ->\n    mediator.game_state = 'admin'\n    @subscribeEvent \"clickAvatar\", @kickPlayer\n    document.body.classList.add \"admin\"\n\n  kickPlayer: (avatar, player, e) ->\n    kick = confirm \"Kick #{player.get('name')}?\"\n    if kick\n      @publishEvent \"admin:kick\", player.id\n\n  uninit: ->\n    mediator.game_state = 'playing'\n    @unsubscribeEvent \"clickAvatar\", @kickPlayer\n    document.body.classList.remove \"admin\"","module.exports = class AutoPilot\n  constructor: (avatar, map) ->\n    @avatar = avatar\n    @map    = map\n\n  travelToPoint: (target) ->\n\n    target.x = target.x - @map.offset_x\n    target.y = target.y - @map.offset_y\n    @travelAvatar(target)\n\n\n  travelAvatar: (target) ->\n    unless @avatar.moving or @avatar.movementLoop\n      @avatar.clearMovementClasses()\n\n      @avatar.movementLoop = setInterval =>\n        current = @getCurrentPosition()\n        dirs = @avatar.directionsByName\n\n        target.x = target.x\n        target.y = target.y\n\n        if @avatar.isCloseEnoughTo(target.x, target.y)\n          return @avatar.stopMovement()\n\n        if current.x > target.x and !(Math.abs(current.x - target.x) < 10)\n          @avatar.addActiveMovementKey dirs['left']\n        else\n          @avatar.stopMovementDirection dirs['left']\n        \n        if current.x < target.x and !(Math.abs(current.x - target.x) < 10)\n          @avatar.addActiveMovementKey dirs['right']\n        else\n          @avatar.stopMovementDirection dirs['right']\n        \n        if current.y < target.y and !(Math.abs(current.y - target.y) < 10)\n          @avatar.addActiveMovementKey dirs['down']\n        else\n          @avatar.stopMovementDirection dirs['down']\n\n        if current.y > target.y and !(Math.abs(current.y - target.y) < 10)\n          @avatar.addActiveMovementKey dirs['up']\n        else\n          @avatar.stopMovementDirection dirs['up']\n\n        @avatar.move()\n\n      , @avatar.movementLoopInc\n\n  getCurrentPosition: ->\n    current = \n      x: @avatar.model.get('x_position')\n      y: @avatar.model.get('y_position')\n    return current","Model            = require 'models/model'\nChatInputView    = require 'views/chat_input_view'\nChatMessage      = require 'models/chat_message'\nSpeechBubbleView = require 'views/speech_bubble_view'\n\nmodule.exports = class ChatterBox extends Model\n  initialize: ->\n    super\n    @subscribeEvent \"messages:received:#{@get('player').id}\", @renderSpeechBubble\n    @subscribeEvent \"messages:dismissed:#{@get('player').id}\", @disposeBubble\n\n  handleEnter: ->\n    if @open\n      @submit()\n    else\n      @openDialog()\n\n  openDialog: ->\n    @speechBubble.dispose() if @speechBubble\n    @open = true\n    @message = new ChatMessage\n      uuid: @get('player').id\n    @dialog = new ChatInputView\n      container: @get('avatar').el\n      autoRender: true\n      model: @message\n      avatar: @get('avatar')\n\n  submit: ->\n    message = @dialog.el.querySelector(\"[name='chat_text']\").value\n    if message = \"/admin\"\n      @publishEvent \"admin:init\"\n      @open = false\n      return @dialog.dispose()\n    @open = false\n    if message\n      @message.set\n        content: message\n      @message.save()\n      @renderSpeechBubble(@message)\n    @dialog.dispose()\n\n  renderSpeechBubble: (message) ->\n    unless message instanceof ChatMessage\n      message = new ChatMessage(message)\n    @speechBubble.dispose() if @speechBubble\n    @speechBubble = new SpeechBubbleView\n      container: @get('avatar').el\n      autoRender: true\n      avatar: @get('avatar')\n      model: message\n      chatterBox: @\n    @message = message\n\n  disposeBubble: (local) ->\n    @open = false\n    @message.dispose() if @message\n    @dialog.dispose() if @dialog\n    @speechBubble.dispose() if @speechBubble\n    if local\n      @publishEvent \"messages:dismissed\", @get('player').id\n\n","channel_prefix = \"players_\"\n\n# Escorts players to a room with capacity\n\nmodule.exports =\n  capacity: 50\n  findEmptyRoom: (PN, cb) ->\n    @testRoom(PN, 0, cb)\n\n  testRoom: (PN, i, cb) ->\n    PN.here_now\n      channel : channel_prefix + i\n      callback : (m) =>\n        if m.uuids.length >= @capacity\n          @testRoom(PN, i+1, cb)\n        else\n          cb(channel_prefix + i)\n","# Taken from Chaplin - https://github.com/chaplinjs/chaplin/blob/master/src/chaplin/lib/event_broker.coffee\n\n'use strict'\n\nmediator = require 'lib/mediator'\n\n# Add functionality to subscribe and publish to global\n# Publish/Subscribe events so they can be removed afterwards\n# when disposing the object.\n#\n# Mixin this object to add the subscriber capability to any object:\n# _.extend object, EventBroker\n# Or to a prototype of a class:\n# _.extend @prototype, EventBroker\n#\n# Since Backbone 0.9.2 this abstraction just serves the purpose\n# that a handler cannot be registered twice for the same event.\n\nEventBroker =\n  subscribeEvent: (type, handler) ->\n    if typeof type isnt 'string'\n      throw new TypeError 'EventBroker#subscribeEvent: ' +\n        'type argument must be a string'\n    if typeof handler isnt 'function'\n      throw new TypeError 'EventBroker#subscribeEvent: ' +\n        'handler argument must be a function'\n\n    # Ensure that a handler isnt registered twice.\n    mediator.unsubscribe type, handler, this\n\n    # Register global handler, force context to the subscriber.\n    mediator.subscribe type, handler, this\n\n  subscribeEventOnce: (type, handler) ->\n    if typeof type isnt 'string'\n      throw new TypeError 'EventBroker#subscribeEventOnce: ' +\n        'type argument must be a string'\n    if typeof handler isnt 'function'\n      throw new TypeError 'EventBroker#subscribeEventOnce: ' +\n        'handler argument must be a function'\n\n    # Ensure that a handler isnt registered twice.\n    mediator.unsubscribe type, handler, this\n\n    # Register global handler, force context to the subscriber.\n    mediator.subscribeOnce type, handler, this\n\n  unsubscribeEvent: (type, handler) ->\n    if typeof type isnt 'string'\n      throw new TypeError 'EventBroker#unsubscribeEvent: ' +\n        'type argument must be a string'\n    if typeof handler isnt 'function'\n      throw new TypeError 'EventBroker#unsubscribeEvent: ' +\n        'handler argument must be a function'\n\n    # Remove global handler.\n    mediator.unsubscribe type, handler\n\n  # Unbind all global handlers.\n  unsubscribeAllEvents: ->\n    # Remove all handlers with a context of this subscriber.\n    mediator.unsubscribe null, null, this\n\n  publishEvent: (type, args...) ->\n    if typeof type isnt 'string'\n      throw new TypeError 'EventBroker#publishEvent: ' +\n        'type argument must be a string'\n\n    # Publish global handler.\n    mediator.publish type, args...\n\n# Youre frozen when your hearts not open.\nObject.freeze? EventBroker\n\n# Return our creation.\nmodule.exports = EventBroker","EventBroker = require 'lib/event_broker'\n\nmodule.exports = [\n  id: \"table\"\n  src: \"/party/images/table.png\"\n  x: 260\n  y: 400\n  # proximity:\n  #   radius: 200\n  #   onEnter: (item, options) ->\n  #     console.log \"ENTERING RADIUS\"\n  #   onLeave: ->\n  #     console.log \"LEAVING RADIUS\"\n,\n  id: \"table2\"\n  src: \"/party/images/table.png\"\n  x: 25\n  y: 400\n,\n  id: \"table3\"\n  src: \"/party/images/table.png\"\n  x: 25\n  y: 475\n,\n  id: \"table4\"\n  src: \"/party/images/table.png\"\n  x: 260\n  y: 475\n,\n  id: \"table5\"\n  src: \"/party/images/table.png\"\n  x: 25\n  y: 800\n,\n  id: \"table8\"\n  src: \"/party/images/table.png\"\n  x: 260\n  y: 800\n,\n  id: \"table6\"\n  src: \"/party/images/table.png\"\n  x: 25\n  y: 875\n,\n  id: \"table7\"\n  src: \"/party/images/table.png\"\n  x: 260\n  y: 875\n,\n  id: \"mac\"\n  src: \"/party/images/mac.png\"\n  x: 345\n  y: 480\n  ghosty: true\n,\n  id: \"mac2\"\n  src: \"/party/images/mac.png\"\n  x: 115\n  y: 480\n  ghosty: true\n,\n  id: \"mac3\"\n  src: \"/party/images/mac.png\"\n  x: 345\n  y: 880\n  ghosty: true\n,\n  id: \"mac4\"\n  src: \"/party/images/mac.png\"\n  x: 115\n  y: 880\n  ghosty: true\n,\n  id: \"macflip\"\n  src: \"/party/images/mac_flip.png\"\n  x: 345\n  y: 410\n  ghosty: true\n,\n  id: \"macflip2\"\n  src: \"/party/images/mac_flip.png\"\n  x: 115\n  y: 410\n  ghosty: true\n,\n  id: \"macflip3\"\n  src: \"/party/images/mac_flip.png\"\n  x: 345\n  y: 810\n  ghosty: true\n,\n  id: \"macflip4\"\n  src: \"/party/images/mac_flip.png\"\n  x: 115\n  y: 810\n,\n  id: \"table_vertical\"\n  src: \"/party/images/table_vertical.png\"\n  x: 900\n  y: 400\n,\n  id: \"table_vertical2\"\n  src: \"/party/images/table_vertical.png\"\n  x: 970\n  y: 400\n,\n  id: \"table_vertical3\"\n  src: \"/party/images/table_vertical.png\"\n  x: 970\n  y: 635\n,\n  id: \"table_vertical4\"\n  src: \"/party/images/table_vertical.png\"\n  x: 900\n  y: 635\n,\n  id: \"orange_chair\"\n  src: \"/party/images/orange_chair.png\"\n  x: 850\n  y: 725\n,\n  id: \"red_chair\"\n  src: \"/party/images/red_chair.png\"\n  x: 1050\n  y: 680\n,\n  id: \"red_chair2\"\n  src: \"/party/images/red_chair.png\"\n  x: 300\n  y: 960\n,\n  id: \"red_chair3\"\n  src: \"/party/images/red_chair.png\"\n  x: 130\n  y: 960\n,\n  id: \"orange_chair5\"\n  src: \"/party/images/orange_chair.png\"\n  x: 310\n  y: 1120\n,\n  id: \"red_chair5\"\n  src: \"/party/images/red_chair.png\"\n  x: 300\n  y: 1260\n,\n  id: \"red_chair4\"\n  src: \"/party/images/red_chair.png\"\n  x: 350\n  y: 560\n,\n  id: \"orange_chair3\"\n  src: \"/party/images/orange_chair.png\"\n  x: 358\n  y: 345\n,\n  id: \"orange_chair4\"\n  src: \"/party/images/orange_chair.png\"\n  x: 375\n  y: 745\n,\n  id: \"orange_chair2\"\n  src: \"/party/images/orange_chair.png\"\n  x: 1050\n  y: 390\n,\n  id: \"bookshelf\"\n  src: \"/party/images/bookshelf.png\"\n  x: 25\n  y: 55\n,\n  id: \"bookshelf2\"\n  src: \"/party/images/bookshelf.png\"\n  x: 110\n  y: 55\n,\n  id: \"bookshelf3\"\n  src: \"/party/images/bookshelf.png\"\n  x: 195\n  y: 55\n,\n  id: \"bookshelf5\"\n  src: \"/party/images/bookshelf.png\"\n  x: 280\n  y: 55\n,\n  id: \"bookshelf4\"\n  src: \"/party/images/bookshelf.png\"\n  x: 690\n  y: 55\n,\n  id: \"couch\"\n  src: \"/party/images/couch.png\"\n  x: 495\n  y: 475\n,\n  id: \"couch2\"\n  src: \"/party/images/couch.png\"\n  x: 495\n  y: 875\n,\n  id: \"couch_flip\"\n  src: \"/party/images/couch_flip.png\"\n  x: 335\n  y: 1175\n,\n  id: \"sharpie_table\"\n  src: \"/party/images/sharpie_table.png\"\n  x: 190\n  y: 550\n,\n  id: \"sharpie_table2\"\n  src: \"/party/images/sharpie_table.png\"\n  x: 215\n  y: 740\n,\n  id: \"sharpie_table3\"\n  src: \"/party/images/sharpie_table.png\"\n  x: 70\n  y: 340\n,\n  id: \"office_table\"\n  src: \"/party/images/office_table.png\"\n  x: 1640\n  y: 1075\n,\n  id: \"long_cabinet\"\n  src: \"/party/images/long_cabinet.png\"\n  x: 500\n  y: 80\n,\n  id: \"long_cabinet2\"\n  src: \"/party/images/long_cabinet.png\"\n  x: 775\n  y: 80\n,\n  id: \"container\"\n  src: \"/party/images/container.png\"\n  x: 965\n  y: 80\n,\n  id: \"container2\"\n  src: \"/party/images/container.png\"\n  x: 1015\n  y: 80\n,\n  id: \"container3\"\n  src: \"/party/images/container.png\"\n  x: 1065\n  y: 80\n,\n  id: \"office_chair\"\n  src: \"/party/images/office_chair.png\"\n  x: 1810\n  y: 1130\n,\n  id: \"office_chair2\"\n  src: \"/party/images/office_chair.png\"\n  x: 1810\n  y: 1230\n,\n  id: \"office_chair3\"\n  src: \"/party/images/office_chair.png\"\n  x: 1810\n  y: 1330\n,\n  id: \"office_chair4\"\n  src: \"/party/images/office_chair.png\"\n  x: 1810\n  y: 1430\n,\n  id: \"office_chair_flip\"\n  src: \"/party/images/office_chair_flip.png\"\n  x: 1605\n  y: 1130\n,\n  id: \"office_chair_flip2\"\n  src: \"/party/images/office_chair_flip.png\"\n  x: 1605\n  y: 1230\n,\n  id: \"office_chair_flip3\"\n  src: \"/party/images/office_chair_flip.png\"\n  x: 1605\n  y: 1330\n,\n  id: \"office_chair_flip4\"\n  src: \"/party/images/office_chair_flip.png\"\n  x: 1605\n  y: 1430\n,\n  id: \"desk_chair\"\n  src: \"/party/images/desk_chair.png\"\n  x: 1055\n  y: 500\n,\n  id: \"desk_chair2\"\n  src: \"/party/images/desk_chair.png\"\n  x: 1055\n  y: 750\n,\n  id: \"desk_chair_flip\"\n  src: \"/party/images/desk_chair_flip.png\"\n  x: 870\n  y: 500\n,\n  id: \"desk_chair_flip2\"\n  src: \"/party/images/desk_chair_flip.png\"\n  x: 870\n  y: 750\n,\n  id: \"fridge\"\n  src: \"/party/images/fridge.png\"\n  x: 1125\n  y: 50\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      hint =\n        obstruction: item\n        text: \"[Interact] View the curious photo on the fridge\"\n        id: \"fridge_hint\"\n        position: 'right'\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"fridge_hint\"\n    keys:\n      action: ->\n        EventBroker.publishEvent 'reactor:act', 'team_photo'\n,\n  id: \"wall\"\n  src: \"/party/images/wall.png\"\n  x: 1630\n  zIndex: 10\n  y: 285\n,\n  id: \"door\"\n  src: \"/party/images/door.png\"\n  x: 1780\n  zIndex: 50\n  y: 315\n  proximity:\n    radius: 10\n    onEnter: (item, options) ->\n      hint =\n        obstruction: item\n        text: \"[Interact] Knock on the door?\"\n        id: \"bathroom_hint\"\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"bathroom_hint\"\n    keys:\n      action: ->\n        EventBroker.publishEvent 'reactor:act', 'bathroom_photo'\n,\n  id: \"wall_2\"\n  src: \"/party/images/wall_2.png\"\n  x: 1630\n  zIndex: 20\n  y: 0\n,\n  id: \"wall_3\"\n  src: \"/party/images/wall3.png\"\n  x: 1430\n  y: 835\n,\n  id: \"wall_4\"\n  src: \"/party/images/wall4.png\"\n  x: 1408\n  y: 835\n,\n  id: \"counter\"\n  src: \"/party/images/counter.png\"\n  x: 1590\n  y: 80\n  zIndex: 25\n,\n  id: \"counter_2\"\n  src: \"/party/images/counter_2.png\"\n  x: 1222\n  y: 82\n,\n  id: \"coffee_table\"\n  src: \"/party/images/coffee_table.png\"\n  x: 200\n  y: 1160\n,\n  id: \"front_table\"\n  src: \"/party/images/front_table.png\"\n  x: 900\n  y: 1060\n,\n  id: \"tree\"\n  src: \"/party/images/tree1.png\"\n  x: 1485\n  y: 530\n,\n  id: \"plant\"\n  src: \"/party/images/plant.png\"\n  x: 955\n  y: 590\n  ghosty: true\n,\n  id: \"Lamp\"\n  src: \"/party/images/lamp_1.png\"\n  x: 990\n  y: 380\n  zIndex: 400\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      EventBroker.publishEvent 'reactor:act', 'lamp_light', item\n    onLeave: (item, options) ->\n      EventBroker.publishEvent 'reactor:act', \"lamp_light\", item\n,\n  id: \"Lamp2\"\n  src: \"/party/images/lamp_1_flip.png\"\n  x: 920\n  y: 680\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      EventBroker.publishEvent 'reactor:act', 'lamp_light_flip', item\n    onLeave: (item, options) ->\n      EventBroker.publishEvent 'reactor:act', \"lamp_light_flip\", item\n,\n  id: \"Lamp3\"\n  src: \"/party/images/lamp_1_flip.png\"\n  x: 190\n  y: 400\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      EventBroker.publishEvent 'reactor:act', 'lamp_light_flip', item\n    onLeave: (item, options) ->\n      EventBroker.publishEvent 'reactor:act', \"lamp_light_flip\", item\n,\n  id: \"Lamp4\"\n  src: \"/party/images/lamp_1.png\"\n  x: 270\n  y: 800\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      EventBroker.publishEvent 'reactor:act', 'lamp_light', item\n    onLeave: (item, options) ->\n      EventBroker.publishEvent 'reactor:act', \"lamp_light\", item\n,\n  id: \"ipad\"\n  src: \"/party/images/ipad.png\"\n  x: 990\n  y: 480\n  ghosty: true\n  mirror: true\n,\n  id: \"ipad4\"\n  src: \"/party/images/ipad.png\"\n  x: 915\n  y: 755\n  ghosty: true\n,\n  id: \"ipad3\"\n  src: \"/party/images/ipad.png\"\n  x: 435\n  y: 515\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      hint = \n        obstruction: item\n        text: \"[Interact] Start the dance party\"\n        id: \"disco_hint\"\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"disco_hint\"\n    keys:\n      action: ->\n        EventBroker.publishEvent 'reactor:act', 'disco'\n,\n  id: \"ipad2\"\n  src: \"/party/images/ipad.png\"\n  x: 630\n  y: 75\n  ghosty: true\n  mirror: true\n,\n  id: \"flamingo\"\n  src: \"/party/images/flamingo.png\"\n  x: 930\n  y: 525\n  ghosty: true\n,\n  id: \"dan\"\n  src: \"/party/images/dan.png\"\n  x: 390\n  y: 70\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      hint =\n        obstruction: item\n        text: \"Go Jayhawks!\"\n        id: \"dan_talk\"\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"dan_talk\"\n,\n  id: \"george\"\n  src: \"/party/images/george.png\"\n  x: 1070\n  y: 1170\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      hint =\n        obstruction: item\n        text: \"Welcome to Cremalab! Try and find the hidden disco mode!\"\n        id: \"george_talk\"\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"george_talk\"\n,\n  id: \"nate\"\n  src: \"/party/images/nate.png\"\n  x: 120\n  y: 520\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      hint =\n        obstruction: item\n        text: \"[interact] Invite your friends to the party!\"\n        id: \"nate_talk\"\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"nate_talk\"\n    keys:\n      action: ->\n        EventBroker.publishEvent 'reactor:act', 'tweet_friends', 'https://twitter.com/home?status=Have%20you%20visited%20the%20%23CremaChristmas%20party%20yet?%20@Cremalab%20used%20@PubNub%20@Brunch%20to%20bring%20it%20to%20life.%20Come%20join%20me!%20cremalab.com/party'\n,\n  id: \"rob\"\n  src: \"/party/images/rob.png\"\n  x: 1520\n  y: 120\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      hint =\n        obstruction: item\n        text: \"Did you bring any food?\"\n        id: \"rob_talk\"\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"rob_talk\"\n,\n  id: \"ross\"\n  src: \"/party/images/ross.png\"\n  x: 1450\n  y: 900\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      hint =\n        obstruction: item\n        text: \"Leave me alone! I'm working!\"\n        id: \"ross_talk\"\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"ross_talk\"\n,\n  id: \"deric\"\n  src: \"/party/images/deric.png\"\n  x: 380\n  y: 1170\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      hint =\n        obstruction: item\n        text: \"We hope you and your family have a great holiday season!\"\n        id: \"deric_talk\"\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"deric_talk\"\n,\n  id: \"kelly\"\n  src: \"/party/images/kelly.png\"\n  x: 1410\n  y: 580\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      hint =\n        obstruction: item\n        text: \"Welcome to our space. Come back anytime!\"\n        id: \"kelly_talk\"\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"kelly_talk\"\n,\n  id: \"John\"\n  src: \"/party/images/john.png\"\n  x: 820\n  y: 1180\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      hint =\n        obstruction: item\n        text: \"Life's a garden... Dig it!\"\n        id: \"john_talk\"\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"john_talk\"\n,\n  id: \"present21\"\n  src: \"/party/images/present_32.png\"\n  x: 1470\n  y: 655\n  ghosty: true\n,\n  id: \"present22\"\n  src: \"/party/images/present_2.png\"\n  x: 1560\n  y: 645\n,\n  id: \"present23\"\n  src: \"/party/images/present_2.png\"\n  x: 940\n  y: 425\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      hint =\n        obstruction: item\n        text: \"Ross wants a new synthesizer!\"\n        id: \"ross_present\"\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"ross_present\"\n,\n  id: \"present24\"\n  src: \"/party/images/present_31.png\"\n  x: 995\n  y: 515\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      hint =\n        obstruction: item\n        text: \"Rob wants the new Call of Duty!\"\n        id: \"rob_present\"\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"rob_present\"\n,\n  id: \"present1\"\n  src: \"/party/images/present_1.png\"\n  x: 1495\n  y: 650\n  ghosty: true\n,\n  id: \"present6\"\n  src: \"/party/images/present_3.png\"\n  x: 1535\n  y: 655\n  ghosty: true\n,\n  id: \"present2\"\n  src: \"/party/images/present_22.png\"\n  x: 1515\n  y: 655\n  ghosty: true\n,\n  id: \"present3\"\n  src: \"/party/images/present_21.png\"\n  x: 925\n  y: 805\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      hint =\n        obstruction: item\n        text: \"Deric wants more Sriracha sauce!\"\n        id: \"deric_present\"\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"deric_present\"\n,\n  id: \"present4\"\n  src: \"/party/images/present_3.png\"\n  zIndex: 100\n  x: 525\n  y: 75\n  ghosty: true\n,\n  id: \"present41\"\n  src: \"/party/images/present_31.png\"\n  zIndex: 100\n  x: 825\n  y: 75\n  ghosty: true\n,\n  id: \"present25\"\n  src: \"/party/images/present_2.png\"\n  zIndex: 100\n  x: 803\n  y: 68\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      hint =\n        obstruction: item\n        text: \"George wants shoes as cool as Bishop's!\"\n        id: \"george_present\"\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"george_present\"\n,\n  id: \"present26\"\n  src: \"/party/images/present_22.png\"\n  zIndex: 1000\n  x: 195\n  y: 498\n  ghosty: true\n,\n  id: \"present27\"\n  src: \"/party/images/present_2.png\"\n  zIndex: 1000\n  x: 195\n  y: 798\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      hint =\n        obstruction: item\n        text: \"Matt wants a new messenger bag!\"\n        id: \"matt_present\"\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"matt_present\"\n,\n  id: \"present51\"\n  src: \"/party/images/present_21.png\"\n  x: 225\n  y: 1160\n  ghosty: true\n,\n  id: \"present5\"\n  src: \"/party/images/present_31.png\"\n  x: 240\n  y: 1175\n  ghosty: true\n,\n  id: \"present7\"\n  src: \"/party/images/present_35.png\"\n  x: 220\n  y: 895\n  ghosty: true\n,\n  id: \"present72\"\n  src: \"/party/images/present_31.png\"\n  x: 415\n  y: 910\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      hint =\n        obstruction: item\n        text: \"Michael wants an iPad air 2!\"\n        id: \"michael_present\"\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"michael_present\"\n,\n  id: \"present71\"\n  src: \"/party/images/present_22.png\"\n  x: 205\n  y: 895\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      hint =\n        obstruction: item\n        text: \"Bishop wants an iPhone 6+!\"\n        id: \"bishop_present\"\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"bishop_present\"\n,\n  id: \"present8\"\n  src: \"/party/images/present_35.png\"\n  x: 1015\n  y: 785\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      hint =\n        obstruction: item\n        text: \"John wants something purple!\"\n        id: \"john_present\"\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"john_present\"\n,\n  id: \"present81\"\n  src: \"/party/images/present_32.png\"\n  x: 1015\n  y: 635\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      hint =\n        obstruction: item\n        text: \"Kelly wants more cheese!\"\n        id: \"kelly_present\"\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"kelly_present\"\n,\n  id: \"present9\"\n  src: \"/party/images/present_33.png\"\n  x: 430\n  y: 410\n  proximity:\n    radius: 60\n    onEnter: (item, options) ->\n      hint =\n        obstruction: item\n        text: \"Dan wants KU basketball tickets!\"\n        id: \"dan_present\"\n      EventBroker.publishEvent 'navi:hint', hint\n    onLeave: ->\n      EventBroker.publishEvent 'navi:dismiss_hint', \"dan_present\"\n,\n  id: \"present11\"\n  src: \"/party/images/present_2.png\"\n  x: 1510\n  y: 65\n  zIndex: 100\n  ghosty: true\n,\n  id: \"present10\"\n  src: \"/party/images/present_32.png\"\n  x: 1530\n  y: 80\n  zIndex: 100\n  ghosty: true\n]\n","Activist = require 'lib/activist'\n\nmodule.exports = class Landscaper\n  landscape: require 'lib/landscape'\n  obstructions: []\n  current_player_overlaps: []\n  constructor: (options) ->\n    @map = options.map\n  init: ->\n    @activist = new Activist(@)\n    for obstruction in @landscape\n      if obstruction.hasOwnProperty 'src'\n        svg = @createObstructionGraphic(obstruction)\n        obstruction = @activist.activate(obstruction)\n        unless obstruction.ghosty\n          @obstructions.push obstruction\n\n\n  createObstructionGraphic: (obstruction) ->\n    position = \"#{obstruction.x}px, #{obstruction.y}px\"\n    img = document.createElement('img')\n    img.id = obstruction.id\n    img.setAttribute('src', obstruction.src)\n    img = @map.el.appendChild(img)\n\n    extension = obstruction.src.split(\".\")\n    extension = extension[extension.length-1]\n    img.style.top  = \"#{obstruction.y}px\"\n    img.style.left = \"#{obstruction.x}px\"\n    img.classList.add 'obstruction'\n\n    if extension is 'svg'\n      @createSVG(obstruction, img)\n    else\n      @createImage(obstruction, img)\n\n\n  createSVG: (obstruction, img) ->\n\n    SVGInjector img, {}, ->\n      img = document.querySelector \"svg##{obstruction.id}\"\n      box = img.getBBox()\n\n      img.x      = obstruction.x\n      img.y      = obstruction.y\n      obstruction.left   = obstruction.x\n      obstruction.top    = obstruction.y\n      obstruction.right  = obstruction.x + box.width\n      obstruction.bottom = obstruction.y + box.height\n      img.classList.add 'svg'\n      if obstruction.mirror\n        img.style.webkitTransform = \"scaleX(-1)\"\n\n      obstruction.svg = img\n\n  createImage: (obstruction, img) ->\n    img  = document.getElementById obstruction.id\n    return imagesLoaded img, ->\n      rect = img.getClientRects()[0]\n      obstruction.left = obstruction.x\n      obstruction.top  = obstruction.y\n      obstruction.right = obstruction.x + rect.width\n      obstruction.bottom = obstruction.y + rect.height\n\n      img.classList.add 'img'\n      img.style.zIndex = obstruction.zIndex or obstruction.y\n      if obstruction.mirror\n        img.style.webkitTransform = \"scaleX(-1)\"\n\n      obstruction.img = img\n\n\n\n  checkObstructions: (x, y, avatar, map) ->\n    availableDirections =\n      right: true\n      left: true\n      up: true\n      down: true\n\n    @rights = []\n    @ups    = []\n    @lefts  = []\n    @downs  = []\n\n    for obstruction in @obstructions\n\n      @getObstructionShape(obstruction, x, y, avatar)\n\n    availableDirections.right = @rights.indexOf(false) < 0\n    availableDirections.left  = @lefts.indexOf(false) < 0\n    availableDirections.up    = @ups.indexOf(false) < 0\n    availableDirections.down  = @downs.indexOf(false) < 0\n\n    if (x + avatar.width) > map.width\n      availableDirections.right = false\n    if x < 0\n      availableDirections.left = false\n    if (y + avatar.height + map.padding_bottom) >= map.height\n      availableDirections.down = false\n    if (y + avatar.height - map.padding_top) < 0\n      availableDirections.up = false\n\n    avatar.availableDirections = availableDirections\n    avatar.trigger 'availableDirectionsUpdated', x, y\n\n\n\n  getObstructionShape: (obstruction, x, y, avatar) ->\n    if obstruction.svg\n      avatarRect = obstruction.svg.createSVGRect()\n    else\n      avatarRect = avatar.rect\n\n    avatarRect.height = avatar.height\n    avatarRect.width = avatar.width\n    player = avatar.model\n    avatarRect.x = player.get('x_position')\n    avatarRect.y = player.get('y_position')\n    @checkIntersections(obstruction, avatarRect, player, x, y, avatar)\n    @checkProximities(avatarRect, obstruction, x, y, avatar) if obstruction.proximity\n\n\n  checkIntersections: (obstruction, avatarRect, player, x, y, avatar) ->\n    if x < avatarRect.x\n      avatarRect.x = x\n      @determineDirections(avatarRect, obstruction, @lefts, 'right', x, y, avatar)\n      avatarRect.x = player.get('x_position')\n    if x > avatarRect.x\n      avatarRect.x = x\n      @determineDirections(avatarRect, obstruction, @rights, 'left', x, y, avatar)\n      avatarRect.x = player.get('x_position')\n    if y < avatarRect.y\n      avatarRect.y = y\n      @determineDirections(avatarRect, obstruction, @ups, 'bottom', x, y, avatar)\n      avatarRect.y = player.get('y_position')\n    if y > avatarRect.y\n      avatarRect.y = y\n      @determineDirections(avatarRect, obstruction, @downs, 'top', x, y, avatar)\n      avatarRect.y = player.get('y_position')\n\n\n  checkProximities: (avatarRect, obstruction, x, y, avatar) ->\n    radius = obstruction.proximity.radius\n    if !radius\n      throw new Error \"Proximity declaration of #{obstruction.id} needs a radius\"\n\n    proximity =\n      top: obstruction.top - radius\n      bottom: obstruction.bottom + radius\n      left: obstruction.left - radius\n      right: obstruction.right + radius\n\n    if @avatarOverlaps(avatar, proximity, x, y)\n      unless obstruction.current_player_overlap\n        @current_player_overlaps.push obstruction.id\n        obstruction.current_player_overlap = true\n        obstruction.raiseEvent 'enterProximity'\n    else\n      if @current_player_overlaps.indexOf(obstruction.id) > -1\n        obstruction.raiseEvent 'leaveProximity'\n        @current_player_overlaps.splice @current_player_overlaps.indexOf(obstruction.id), 1\n        obstruction.current_player_overlap = false\n\n\n  determineDirections: (avatarRect, obstruction, array, dir, x, y, avatar) ->\n    if obstruction.svg\n      @determineSVGDirections(avatarRect, obstruction, array, dir, x, y, avatar)\n    else\n      @determineImgDirections(avatarRect, obstruction, array, dir, x, y, avatar)\n\n  determineImgDirections: (avatarRect, obstruction, array, dir, x, y, avatar) ->\n    # use avatar.width to ignore player name making it wider\n\n    if @avatarOverlaps(avatar, obstruction, x, y)\n      array.push false\n      @dispatchHitActions(obstruction, dir, x, y, avatar)\n    else\n      array.push true\n\n  determineSVGDirections: (avatarRect, obstruction, array, dir, x, y, avatar) ->\n    if obstruction.svg.getIntersectionList(avatarRect, null).length < 1\n      array.push true\n    else\n      array.push false\n      @dispatchHitActions(obstruction, dir, x, y, avatar)\n\n  dispatchHitActions: (obstruction, dir, x, y, avatar) ->\n    options =\n      avatar: avatar\n      x: x\n      y: y\n    obstruction.raiseEvent \"hit_#{dir}\", options\n    obstruction.raiseEvent \"hit_any\", options\n\n  avatarOverlaps: (a, b, x, y) ->\n    aLeftOfB  = (x + a.width) < b.left\n    aRightOfB = x > b.right\n    aBelowB   = y > b.bottom\n    aAboveB   = (y + a.height) < b.top\n\n    return !( aLeftOfB || aRightOfB || aAboveB || aBelowB )\n","'use strict'\n\n# Mediator\n# --------\n\n# The mediator is a simple object all other modules use to communicate\n# with each other. It implements the Publish/Subscribe pattern.\n#\n# Additionally, it holds objects which need to be shared between modules.\n# In this case, a `user` property is created for getting the user object\n# and a `setUser` method for setting the user.\n#\n# This module returns the singleton object. This is the\n# application-wide mediator you might load into modules\n# which need to talk to other modules using Publish/Subscribe.\n\n\n# Start with a simple object\nmediator = {}\n\n# Publish / Subscribe\n# -------------------\n\n# Mixin event methods from Backbone.Events,\n# create Publish/Subscribe aliases.\nmediator.subscribe     = mediator.on      = Backbone.Events.on\nmediator.subscribeOnce = mediator.once    = Backbone.Events.once\nmediator.unsubscribe   = mediator.off     = Backbone.Events.off\nmediator.publish       = mediator.trigger = Backbone.Events.trigger\n\n# Initialize an empty callback list so we might seal the mediator later.\nmediator._callbacks = null\n\nmediator.current_player = null\nmediator.game_state = null\n\n# Request / Response\n# -----------------\n\n# Like pub / sub, but with one handler. Similar to OOP message passing.\n\nhandlers = mediator._handlers = {}\n\n# Sets a handler function for requests.\nmediator.setHandler = (name, method, instance) ->\n  handlers[name] = {instance, method}\n\n# Retrieves a handler function and executes it.\nmediator.execute = (nameOrObj, args...) ->\n  silent = false\n  if typeof nameOrObj is 'object'\n    silent = nameOrObj.silent\n    name = nameOrObj.name\n  else\n    name = nameOrObj\n  handler = handlers[name]\n  if handler\n    handler.method.apply handler.instance, args\n  else if not silent\n    throw new Error \"mediator.execute: #{name} handler is not defined\"\n\n# Removes handlers from storage.\n# Can take no args, list of handler names or instance which had bound handlers.\nmediator.removeHandlers = (instanceOrNames) ->\n  unless instanceOrNames\n    mediator._handlers = {}\n\n  if Array.isArray instanceOrNames\n    for name in instanceOrNames\n      delete handlers[name]\n  else\n    for name, handler of handlers when handler.instance is instanceOrNames\n      delete handlers[name]\n  return\n\n# Sealing the mediator\n# --------------------\n\n# After adding all needed properties, you should seal the mediator\n# using this method.\nmediator.seal = ->\n  # Prevent extensions and make all properties non-configurable.\n  if support.propertyDescriptors and Object.seal\n    Object.seal mediator\n\n# Make the method readonly.\n# utils.readonly mediator, 'seal'\n\n# Return our creation.\nmodule.exports = mediator","# \"Hey, listen!\"\n# Adds hints and tooltips to map on events\n\nEventBroker = require 'lib/event_broker'\nHint        = require 'models/hint'\nHintView    = require 'views/hint_view'\n\nmodule.exports = class Navi\n  Backbone.utils.extend @prototype, EventBroker\n  subviews: []\n  hints: []\n\n  constructor: (map) ->\n    @map = map\n    @subscribeEvent \"navi:hint\", @hint\n    @subscribeEvent \"navi:dismiss_hint\", @removeHint\n\n  hint: (options) ->\n    hint = new Hint options\n    @hints.push hint\n    view = new HintView\n      model: hint\n      container: @map.el\n      autoRender: true\n    @subviews.push view\n\n  removeHint: (id) ->\n    match = @hints.filter (item) ->\n      item.id is id\n    match = match[0]\n    if match\n      match.dispose()\n      @hints.splice(@hints.indexOf(match), 1)\n      @subviews.splice(@hints.indexOf(match), 1)\n\n\n\n","EventBroker = require 'lib/event_broker'\nmediator    = require 'lib/mediator'\nactions     = require 'lib/actions'\n\nmodule.exports = class Reactor\n  Backbone.utils.extend @prototype, EventBroker\n  constructor: (mapView, players) ->\n    @map     = mapView\n    @players = players\n    @actions = actions\n    @subscribeEvent 'reactor:act', (actionName, options...) =>\n      @actions[actionName](@map, options)\n\n\n\n","utils = \n\n  getAllPropertyVersions: (object, property) ->\n    result = []\n    for proto in utils.getPrototypeChain object\n      value = proto[property]\n      if value and value not in result\n        result.push value\n    result\n\n  # Simple duck-typing serializer for models and collections.\n  serialize: (data) ->\n    if typeof data.serialize is 'function'\n      data.serialize()\n    else if typeof data.toJSON is 'function'\n      data.toJSON()\n    else\n      throw new TypeError 'utils.serialize: Unknown data was passed'\n\n  # Get the whole chain of object prototypes.\n  getPrototypeChain: (object) ->\n    chain = [object.constructor.prototype]\n    while object = object.constructor?.superclass?.prototype ? object.constructor?.__super__\n      chain.push object\n    chain.reverse()\n\nmodule.exports = utils","flakeCount = 200\nmX = -100\nmY = -100\nflakes = []\n\nreset = (flake, canvas) ->\n  flake.x = Math.floor(Math.random() * canvas.width)\n  flake.y = 0\n  flake.size = (Math.random() * 3) + 2\n  flake.speed = (Math.random() * 1) + 0.5\n  flake.velY = flake.speed\n  flake.velX = 0\n  flake.opacity = (Math.random() * 0.5) + 0.3\n  return\nstartSnow = (canvasId) ->\n  requestAnimationFrame = window.requestAnimationFrame or window.mozRequestAnimationFrame or window.webkitRequestAnimationFrame or window.msRequestAnimationFrame or (callback) ->\n    window.setTimeout callback, 1000 / 60\n    return\n\n  window.requestAnimationFrame = requestAnimationFrame\n\n  canvas = document.getElementById(canvasId)\n  ctx = canvas.getContext(\"2d\")\n  canvas.width = window.innerWidth\n  canvas.height = window.innerHeight\n  canvas.addEventListener \"mousemove\", (e) ->\n    mX = e.clientX\n    mY = e.clientY\n\n    return\n\n  i = 0\n\n  while i < flakeCount\n    x = Math.floor(Math.random() * canvas.width)\n    y = Math.floor(Math.random() * canvas.height)\n    size = (Math.random() * 3) + 2\n    speed = (Math.random() * 1) + 0.5\n    opacity = (Math.random() * 0.5) + 0.3\n    flakes.push\n      speed: speed\n      velY: speed\n      velX: 0\n      x: x\n      y: y\n      size: size\n      stepSize: (Math.random()) / 30\n      step: 0\n      angle: 180\n      opacity: opacity\n\n    i++\n  doSnow(ctx, canvas)\n  return\n\ndoSnow = (ctx, canvas) ->\n  ctx.clearRect 0, 0, canvas.width, canvas.height\n  i = 0\n\n  while i < flakeCount\n    flake = flakes[i]\n    x = mX\n    y = mY\n    minDist = 150\n    x2 = flake.x\n    y2 = flake.y\n    dist = Math.sqrt((x2 - x) * (x2 - x) + (y2 - y) * (y2 - y))\n    dx = x2 - x\n    dy = y2 - y\n    if dist < minDist\n      force = minDist / (dist * dist)\n      xcomp = (x - x2) / dist\n      ycomp = (y - y2) / dist\n      deltaV = force / 2\n      flake.velX -= deltaV * xcomp\n      flake.velY -= deltaV * ycomp\n    else\n      flake.velX *= .98\n      flake.velY = flake.speed  if flake.velY <= flake.speed\n      flake.velX += Math.cos(flake.step += .05) * flake.stepSize\n    ctx.fillStyle = \"rgba(255,255,255,\" + flake.opacity + \")\"\n    flake.y += flake.velY\n    flake.x += flake.velX\n    reset(flake, canvas)  if flake.y >= canvas.height or flake.y <= 0\n    reset(flake, canvas)  if flake.x >= canvas.width or flake.x <= 0\n    ctx.beginPath()\n    ctx.arc flake.x, flake.y, flake.size, 0, Math.PI * 2\n    ctx.fill()\n    i++\n  requestAnimationFrame ->\n    doSnow(ctx, canvas)\n  return\n\nweather = \n  snow: (canvasId) ->\n    startSnow(canvasId)\n\nmodule.exports = weather","Model = require 'models/model'\n\nmodule.exports = class ChatMessage extends Model\n  save: ->\n    @publishEvent 'messages:saved', @attributes","EventBroker = require 'lib/event_broker'\n\n# Base class for all collections.\nmodule.exports = class Collection extends Backbone.Collection\n  Backbone.utils.extend @prototype, EventBroker\n","Model = require 'models/model'\n\nmodule.exports = class Hint extends Model","EventBroker = require 'lib/event_broker'\n\n# Base class for all models.\nmodule.exports = class Model extends Backbone.Model\n  Backbone.utils.extend @prototype, EventBroker\n\n  disposed: false\n\n  dispose: ->\n    return if @disposed\n\n    # Fire an event to notify associated collections and views.\n    @trigger 'dispose', this\n\n    # Unbind all global event handlers.\n    @unsubscribeAllEvents()\n\n    # Unbind all referenced handlers.\n    @stopListening()\n\n    # Remove all event handlers on this module.\n    @off()\n\n    # Remove the collection reference, internal attribute hashes\n    # and event handlers.\n    properties = [\n      'collection',\n      'attributes', 'changed', 'defaults',\n      '_escapedAttributes', '_previousAttributes',\n      '_silent', '_pending',\n      '_callbacks'\n    ]\n    delete this[prop] for prop in properties\n\n    # Finished.\n    @disposed = true","mediator = require 'lib/mediator'\nModel    = require 'models/model'\nEscort   = require 'lib/escort'\nModal    = require 'views/modal_view'\n\nmodule.exports = class Notifier extends Model\n  connect: (player, onConnect) ->\n    @player = player\n    @PN = PUBNUB.init\n      # Be cool with these keys, developer dudes\n      publish_key: 'pub-c-7f96182e-eed7-46dd-9b72-80d838427d8e',\n      subscribe_key: 'sub-c-b9f703c2-7109-11e4-aacc-02ee2ddab7fe'\n      uuid: player.get('id')\n      heartbeat: 10\n      restore: false\n\n    Escort.findEmptyRoom @PN, (channel_name) =>\n      @subscribe(channel_name, onConnect)\n      @subscribeEvent 'playerMoved', @publishPlayerMovement\n      @subscribeEvent \"players:left\", @removePlayer\n      @subscribeEvent \"messages:saved\", @publishMessage\n      @subscribeEvent \"messages:dismissed\", @dismissMessage\n      @subscribeEvent \"players:name_changed\", @setAttrs\n      @subscribeEvent \"players:avatar_changed\", @setAttrs\n      @subscribeEvent \"admin:kick\", @publishKick\n\n      pubnub = @PN\n\n      window.addEventListener \"beforeunload\", (e) =>\n        @PN.unsubscribe\n          channel: @channel\n\n  subscribe: (channel, onConnect) ->\n    attrs = @player.toJSON()\n    delete attrs.active\n    @PN.subscribe\n      channel: channel\n      presence: (m) =>\n        @handlePresence(m)\n      message: (m) =>\n        @message(m)\n      state: attrs\n      connect: =>\n        @channel = channel\n        @getRoomPlayers(onConnect)\n\n  getRoomPlayers: (onConnect) ->\n    @PN.here_now\n      channel : @channel\n      state: true\n      callback: (message) =>\n        @handlePlayers(message, onConnect)\n\n  message: (m) ->\n    if m.type\n      switch m.type\n        when 'chat_message'\n          unless mediator.current_player.id is m.uuid\n            @publishEvent \"messages:received:#{m.uuid}\", m\n        when 'chat_message_dismissed'\n          @publishEvent \"messages:dismissed:#{m.uuid}\"\n        when 'kick'\n          @removePlayer(m.uuid, true)\n\n  handlePlayers: (message, onConnect) ->\n    if message.uuids\n      for player in message.uuids\n        unless parseInt(player.uuid) is parseInt(@player.get('id'))\n          @publishEvent 'addPlayer', player.uuid, player.state\n    \n    onConnect(@channel) if onConnect\n\n  handlePresence: (m,a) ->\n    unless m.uuid is mediator.current_player.id\n      switch m.action\n        when 'join'\n          @publishEvent 'addPlayer', m.uuid, m.data\n        when 'state-change'\n          @publishEvent \"players:moved:#{m.uuid}\", m.data\n        when 'leave'\n          @publishEvent \"players:left\", m.uuid\n        when 'timeout'\n          @publishEvent \"players:left\", m.uuid\n\n  publishPlayerMovement: (player) ->\n    x_position  = player.get('x_position')\n    y_position  = player.get('y_position')\n    orientation = player.get('orientation')\n    name        = player.get('name')\n    moving      = player.get('moving')\n    @setAttrs(player)\n\n  removePlayer: (id, kicked) ->\n    if mediator.current_player.id is id\n      console.log 'unsubscribe'\n      @PN.unsubscribe\n        channel: @channel\n      if kicked\n        @notifyKick(id)\n\n  publishMessage: (attributes) ->\n    attributes.type = 'chat_message'\n    @PN.publish\n      channel: @channel\n      message: attributes\n\n  publishKick: (uuid) ->\n    attributes =\n      type: 'kick'\n      uuid: uuid\n\n    @PN.publish\n      channel: @channel\n      message: attributes\n\n  notifyKick: (uuid) ->\n    if mediator.current_player.id is uuid\n      console.log 'notify!'\n      new Modal\n        template: require 'views/templates/kick'\n        className: 'modal'\n        container: document.body\n        autoRender: true\n\n  dismissMessage: (uuid) ->\n    @PN.publish\n      channel: @channel\n      message:\n        type: 'chat_message_dismissed'\n        uuid: uuid\n\n  setAttrs: (player) ->\n    attrs = player.toJSON()\n    delete attrs.active\n    @PN.state\n      channel  : @channel\n      state    : attrs","mediator = require 'lib/mediator'\nModel = require 'models/model'\n\nmodule.exports = class Player extends Model\n  movement_inc: 0\n  defaults:\n    x_position: 0\n    y_position: 0\n\n  initialize: ->\n    super\n    @listenTo @, \"change:x_position change:y_position change:orientation change:moving\", @streamPosition\n    @listenTo @, \"change:name\", @publishNameChange\n    @subscribeEvent \"players:moved:#{@id}\", @setPosition\n    @subscribeEvent \"players:left\", @handleLeave\n\n  position: ->\n    return \"#{@get('x_position')}px, #{@get('y_position')}px\"\n\n  isCurrentPlayer: ->\n    parseInt(mediator.current_player.id) is parseInt(@id)\n\n  setPosition: (data) ->\n    unless @isCurrentPlayer()\n      @set data\n\n  streamPosition: ->\n    @movement_inc++\n    triggerMove = @movement_inc is 5 or \n      @hasChanged('orientation') or \n      @hasChanged('moving')\n    if triggerMove\n      @movement_inc = 0\n      @publishEvent 'playerMoved', @ if @isCurrentPlayer()\n      @set('z-plane', @get('y_position'))\n\n  leaveRoom: ->\n    @publishEvent 'players:left', @id\n\n  handleLeave: (id) ->\n    if id is @id\n      @dispose()\n\n  publishNameChange: ->\n    @publishEvent 'players:name_changed', @ if @isCurrentPlayer()\n    @save()\n\n  save: ->\n    if @isCurrentPlayer()\n      attrs = @toJSON()\n      delete attrs.id\n      delete attrs.active\n      localStorage.setItem \"CremalabPartyAvatar\", JSON.stringify(@toJSON())\n      @publishEvent \"players:avatar_changed\", @\n      return @\n\n  dispose: ->\n    @trigger 'dispose'\n    super","Collection  = require './collection'\n\nmodule.exports = class Players extends Collection\n  initialize: ->\n    super\n    @subscribeEvent \"players:left\", (m) =>\n      @remove(m)","Model = require 'models/model'\n\nmodule.exports = class Trailblazer extends Model\n  initialize: (options) ->\n    super\n    @canvas = options.canvas\n    @avatar = options.avatar\n    @player = @avatar.model\n    @plots  = []\n    @plot_count = 0\n\n    @listenTo @player, 'change:x_position change:y_position', (x,y) =>\n      @plot_count++\n\n      # if @plot_count % 5 is 0\n      plot =\n        x: @player.get('x_position')\n        y: @player.get('y_position')\n      @plots.push(plot)\n      @cleanupPlots()\n      @canvas.addPointToTrail @getStartEnd(@plots), @player, @avatar\n\n  getStartEnd: (plots) ->\n    if plots.length > 1\n      last   = plots[plots.length - 2]\n      latest = plots[plots.length - 1]\n    else\n      last =\n        x: @player.get('x_position') + (@avatar.width/1.65)\n        y: @player.get('y_position') + (@avatar.height)\n      if plots.length\n        latest = plots[plots.length]\n        latest = last unless latest\n\n    latest.x = latest.x + (@avatar.width/1.65)\n    latest.y = latest.y + (@avatar.height)\n    return [last, latest]\n\n  cleanupPlots: ->\n    if @plots.length > 10\n      @plots.shift()\n","View       = require './view'\nChatterBox = require 'lib/chatterbox'\nmediator   = require 'lib/mediator'\n\nleft  = 37\nup    = 38\nright = 39\ndown  = 40\n\n\nmodule.exports = class Avatar extends View\n  directionsByName:\n    left: left\n    up: up\n    right: right\n    down: down\n  directionsByCode:\n    37: \"left\"\n    38: \"up\"\n    39: \"right\"\n    40: \"down\"\n  template: require './templates/avatar'\n  autoRender: false\n  className: 'avatar'\n  movementInc: 8\n  movementLoopInc: 30\n  moving: false\n  activeMovementKeys: []\n  movementKeys: [left, up, right, down]\n  availableDirections:\n    left: true\n    right: true\n    up: true\n    down: true\n\n  initialize: (options) ->\n    if options.template\n      @template = options.template\n    @soulless = options.soulless\n    super\n    @listenTo @model, \"change:avatar-gender change:avatar-hat change:avatar-hair change:avatar-skin change:avatar-coat change:avatar-pants\", @updateLook\n    @listenTo @model, \"dispose\", @dispose\n    @listenTo @model, \"change:z-plane\", @updateZIndex\n    @subscribeEvent \"players:left\", @handleLeave\n    unless @model.isCurrentPlayer()\n      @listenTo @model, \"change:moving\", =>\n        @setMovementClasses()\n    unless @soulless\n      @listenTo @model, \"change:x_position change:y_position change:orientation\", @broadCastMove\n      @listenTo @, \"availableDirectionsUpdated\", @updatePosition\n      @chatterbox = new ChatterBox\n        player: @model\n        avatar: @\n\n    @listenTo @model, \"change:orientation\", @orient\n    @listenTo @model, \"change:name\", @setName\n\n  render: ->\n    super\n    if @soulless\n      @orient(@model, 0)\n    else\n      @positionOnMap()\n      @bindEvents()\n      @el.setAttribute('data-pos', 7)\n      setTimeout(=>\n        @rect = @el.getClientRects()[0]\n        @boundingRect = @el.getBoundingClientRect()\n        @setDimensions()\n      , 0)\n      if @model.get('active')\n        @el.classList.add 'active'\n      if @model.isCurrentPlayer()\n        @el.addEventListener 'touchstart', (e) =>\n          e.preventDefault()\n          e.stopPropagation()\n          @chatterbox.handleEnter();\n      @orient(@model, @model.get('orientation'))\n    @updateLook()\n    @updateZIndex()\n\n  bindEvents: ->\n    @el.addEventListener 'click', @publishClick\n    if @model.isCurrentPlayer()\n      document.addEventListener 'keydown', @handleKeyDown\n      document.addEventListener 'keyup', @handleKeyUp\n\n  broadCastMove: (player) ->\n    unless player.isCurrentPlayer()\n      @positionOnMap()\n      @trigger('playerMove', player, @)\n\n  handleKeyDown: (e) =>\n    e.stopPropagation()\n    unless mediator.game_state is 'modal'\n      if @isMovementKey(e) and @activeMovementKeys.indexOf(e.keyCode) < 0\n        @addActiveMovementKey e.keyCode\n\n        unless @moving or @movementLoop\n          @clearMovementClasses()\n          @movementLoop = setInterval =>\n            @move()\n          , @movementLoopInc\n\n      if e.keyCode is 16 # shift\n        @addActiveMovementKey e.keyCode\n      if e.keyCode is 13 # return/enter\n        @chatterbox.handleEnter(e)\n      if e.keyCode is 27 # esc\n        @chatterbox.disposeBubble(true)\n\n  move: (keys) ->\n\n    @moving = true\n    @model.set('moving', true)\n\n    @checkCollision()\n    if !@isMovingDirection(up) and\n      !@isMovingDirection(down) and\n      !@isMovingDirection(left) and\n      !@isMovingDirection(right)\n        @moving = false\n        @model.set('moving', false)\n        @stopMovementLoop()\n\n    new_x = @model.get('x_position')\n    new_y = @model.get('y_position')\n\n    if @isMovingDirection(up)\n      new_y = @model.get('y_position') + -@movementInc\n    if @isMovingDirection(down)\n      new_y = @model.get('y_position') + @movementInc\n    if @isMovingDirection(left)\n      new_x = @model.get('x_position') + -@movementInc\n    if @isMovingDirection(right)\n      new_x = @model.get('x_position') + @movementInc\n\n    # Let MapView know the player wants to move\n    @trigger 'playerMove', new_x, new_y, @\n\n    @setMovementClasses()\n    @setOrientation()\n\n    @positionOnMap()\n\n  positionOnMap: ->\n    @position_x = @model.get('x_position')\n    @position_y = @model.get('y_position')\n    @el.style.webkitTransform = \"translate3d(#{@model.position()}, 0)\"\n    @el.style.MozTransform = \"translate3d(#{@model.position()}, 0)\"\n    @el.style.transform = \"translate3d(#{@model.position()}, 0)\"\n\n  addActiveMovementKey: (key) ->\n    if @activeMovementKeys.indexOf(key) < 0\n      @activeMovementKeys.push key\n\n  travelToPoint: (x, y) ->\n    target =\n      x: x\n      y: y\n    @autopilot.travelToPoint(target, @)\n\n  orient: (player, orientation) ->\n    @el.setAttribute('data-pos', orientation)\n\n  handleKeyUp: (e) =>\n    @stopMovement(e)\n    if e.keyCode is 16 # shift\n      @stopMovementDirection e.keyCode\n\n\n  stopMovement: (e) ->\n    if e and e.keyCode\n      if @activeMovementKeys.indexOf(e.keyCode) > -1\n        @stopMovementDirection(e.keyCode)\n\n      if @activeMovementKeys.length is 0\n        @stopMovementLoop()\n        @moving = false\n\n      @el.classList.remove @directionsByCode[e.keyCode] if @moving\n    else\n      @stopMovementLoop()\n      @activeMovementKeys = []\n      @moving = false\n\n    @setMovementClasses()\n    @setOrientation()\n    # @trigger 'playerMove', @model.get('x_position'), @model.get('y_position'), @\n\n  isMovementKey: (e) ->\n    return @movementKeys.indexOf(e.keyCode) > -1\n\n  isMovingDirection: (keyCode) ->\n    if keyCode.isArray\n      return keyCode.every (e) ->\n        @activeMovementKeys.indexOf(e) > -1\n    @activeMovementKeys.indexOf(keyCode) > -1\n\n  isShiftKeyDown: () ->\n    return @activeMovementKeys.indexOf(16) > -1\n\n  setMovementClasses: ->\n    classList = @el.classList\n    classToAdd = ''\n\n    if @model.get('moving')\n      classList.add 'moving'\n    else\n      classList.remove 'moving'\n\n    @clearMovementClasses()\n\n    if @isMovingDirection(up)\n      classList.add 'dir-up'\n\n    if @isMovingDirection(down)\n      classList.add 'dir-down'\n\n    if @isMovingDirection(left)\n      classList.add 'dir-left'\n\n    if @isMovingDirection(right)\n      classList.add 'dir-right'\n\n  setOrientation: ->\n    cl = @el.classList\n    if cl.contains('dir-up') and cl.contains('dir-left')\n      if @isShiftKeyDown()\n        return @model.set('orientation', 1)\n      return @model.set('orientation', 5)\n    if cl.contains('dir-up') and cl.contains('dir-right')\n      if @isShiftKeyDown()\n        return @model.set('orientation', 7)\n      return @model.set('orientation', 3)\n    if cl.contains('dir-down') and cl.contains('dir-left')\n      if @isShiftKeyDown()\n        return @model.set('orientation', 3)\n      return @model.set('orientation', 7)\n    if cl.contains('dir-down') and cl.contains('dir-right')\n      if @isShiftKeyDown()\n        return @model.set('orientation', 5)\n      return @model.set('orientation', 1)\n    if cl.contains('dir-up')\n      if @isShiftKeyDown()\n        return @model.set('orientation', 0)\n      return @model.set('orientation', 4)\n    if cl.contains('dir-down')\n      if @isShiftKeyDown()\n        return @model.set('orientation', 4)\n      return @model.set('orientation', 0)\n    if cl.contains('dir-right')\n      if @isShiftKeyDown()\n        return @model.set('orientation', 6)\n      return @model.set('orientation', 2)\n    if cl.contains('dir-left')\n      if @isShiftKeyDown()\n        return @model.set('orientation', 2)\n      return @model.set('orientation', 6)\n\n  clearMovementClasses: ->\n    classList = @el.classList\n    classList.remove('dir-up')\n    classList.remove('dir-down')\n    classList.remove('dir-left')\n    classList.remove('dir-right')\n\n  stopMovementLoop: ->\n    clearInterval(@movementLoop)\n    @model.set('moving', false)\n    @movementLoop = null\n\n  stopMovementDirection: (keyCode) ->\n    if @activeMovementKeys.indexOf(keyCode) > -1\n      @activeMovementKeys.splice(@activeMovementKeys.indexOf(keyCode), 1)\n\n  setDimensions: ->\n    @width = @rect.right - @rect.left\n    @height = @rect.bottom - @rect.top\n\n  checkCollision: ->\n    blocked_up    = @isMovingDirection(up) and !@availableDirections.up\n    blocked_down  = @isMovingDirection(down) and !@availableDirections.down\n    blocked_left  = @isMovingDirection(left) and !@availableDirections.left\n    blocked_right = @isMovingDirection(right) and !@availableDirections.right\n\n    @stopMovementDirection(up) if blocked_up\n    @stopMovementDirection(down) if blocked_down\n    @stopMovementDirection(left) if blocked_left\n    @stopMovementDirection(right) if blocked_right\n\n  updatePosition: (new_x,new_y) ->\n    if  (new_x > @model.get('x_position') and @availableDirections.right) or\n        (new_x < @model.get('x_position') and @availableDirections.left)\n          @model.set('x_position', new_x)\n\n    if  (new_y > @model.get('y_position') and @availableDirections.down) or\n        (new_y < @model.get('y_position') and @availableDirections.up)\n          @model.set('y_position', new_y)\n\n  isCloseEnoughTo: (x, y) ->\n    px = Math.abs(x - @model.get('x_position')) < 20\n    py = Math.abs(y - @model.get('y_position')) < 20\n    return px and py\n\n  setName: ->\n    name = @model.get('name')\n    @el.querySelector('.player-name').innerText = name\n\n  updateLook: ->\n    @el.className = 'avatar'\n    @el.classList.add 'active' if @model.get('active')\n    @el.setAttribute('data-gender', @model.get('avatar-gender'))\n    @el.classList.add @model.get('avatar-hat')\n    @el.classList.add @model.get('avatar-hair')\n    @el.classList.add @model.get('avatar-skin')\n    @el.classList.add @model.get('avatar-coat')\n    @el.classList.add @model.get('avatar-pants')\n    if @model.isCurrentPlayer()\n      @model.save()\n\n  updateZIndex: ->\n    @el.style.zIndex = @model.get('y_position')\n\n  handleLeave: (id) ->\n    if @model\n      if parseInt(id) is parseInt(@model.id)\n        @dispose()\n\n  publishClick: (e) =>\n    console.log 'click avatar'\n    @publishEvent \"clickAvatar\", @, @model, e\n\n  dispose: ->\n    document.removeEventListener 'keydown', @handleKeyDown\n    document.removeEventListener 'keyup', @handleKeyUp\n    super","View     = require 'views/view'\ntemplate = require './templates/chat_input'\n\nmodule.exports = class ChatInputView extends View\n  template: template\n  className: 'chat-dialog speech-bubble'\n  render: ->\n    super\n    setTimeout =>\n      @el.querySelector('input').focus()\n    , 0\n    @el.querySelector('input').addEventListener 'blur', ->\n      window.scrollTo(0, 0)\n","'use strict'\n\nView = require './view'\n\n# Shortcut to access the DOM manipulation library.\n$ = Backbone.$\n\nfilterChildren = (nodeList, selector) ->\n  return nodeList unless selector\n  for node in nodeList when Backbone.utils.matchesSelector node, selector\n    node\n\ntoggleElement = do ->\n  if $\n    (elem, visible) -> elem.toggle visible\n  else\n    (elem, visible) ->\n      elem.style.display = (if visible then '' else 'none')\n\naddClass = do ->\n  if $\n    (elem, cls) -> elem.addClass cls\n  else\n    (elem, cls) -> elem.classList.add cls\n\ninsertView = do ->\n  if $\n    (list, viewEl, position, length, itemSelector) ->\n      insertInMiddle = (0 < position < length)\n      isEnd = (length) -> length is 0 or position is length\n\n      if insertInMiddle or itemSelector\n        # Get the children which originate from item views.\n        children = list.children itemSelector\n        childrenLength = children.length\n\n        # Check if it needs to be inserted.\n        unless children[position] is viewEl\n          if isEnd childrenLength\n            # Insert at the end.\n            list.append viewEl\n          else\n            # Insert at the right position.\n            if position is 0\n              children.eq(position).before viewEl\n            else\n              children.eq(position - 1).after viewEl\n      else\n        method = if isEnd length then 'append' else 'prepend'\n        list[method] viewEl\n  else\n    (list, viewEl, position, length, itemSelector) ->\n      insertInMiddle = (0 < position < length)\n      isEnd = (length) -> length is 0 or position is length\n\n      if insertInMiddle or itemSelector\n        # Get the children which originate from item views.\n        children = filterChildren list.children, itemSelector\n        childrenLength = children.length\n\n        # Check if it needs to be inserted.\n        unless children[position] is viewEl\n          if isEnd childrenLength\n            # Insert at the end.\n            list.appendChild viewEl\n          else if position is 0\n            # Insert at the right position.\n            list.insertBefore viewEl, children[position]\n          else\n            last = children[position - 1]\n            if list.lastChild is last\n              list.appendChild viewEl\n            else\n              list.insertBefore viewEl, last.nextElementSibling\n      else if isEnd length\n        list.appendChild viewEl\n      else\n        list.insertBefore viewEl, list.firstChild\n\n# General class for rendering Collections.\n# Derive this class and declare at least `itemView` or override\n# `initItemView`. `initItemView` gets an item model and should instantiate\n# and return a corresponding item view.\nmodule.exports = class CollectionView extends View\n  # Configuration options\n  # =====================\n\n  # These options may be overwritten in derived classes.\n\n  # A class of item in collection.\n  # This property has to be overridden by a derived class.\n  itemView: null\n\n  # Automatic rendering\n  # -------------------\n\n  # Per default, render the view itself and all items on creation.\n  autoRender: true\n  renderItems: true\n  # Selectors and elements\n  # ----------------------\n\n  # A collection view may have a template and use one of its child elements\n  # as the container of the item views. If you specify `listSelector`, the\n  # item views will be appended to this element. If empty, $el is used.\n  listSelector: null\n\n  # The actual element which is fetched using `listSelector`\n  $list: null\n\n  # Selector for a fallback element which is shown if the collection is empty.\n  fallbackSelector: null\n\n  # The actual element which is fetched using `fallbackSelector`\n  $fallback: null\n\n  # Selector for a loading indicator element which is shown\n  # while the collection is syncing.\n  loadingSelector: null\n\n  # The actual element which is fetched using `loadingSelector`\n  $loading: null\n\n  # Selector which identifies child elements belonging to collection\n  # If empty, all children of $list are considered.\n  itemSelector: null\n\n  # Filtering\n  # ---------\n\n  # The filter function, if any.\n  filterer: null\n\n  # A function that will be executed after each filter.\n  # Hides excluded items by default.\n  filterCallback: (view, included) ->\n    view.$el.stop(true, true) if $\n    toggleElement (if $ then view.$el else view.el), included\n\n  # View lists\n  # ----------\n\n  # Track a list of the visible views.\n  visibleItems: null\n\n  # Constructor\n  # -----------\n\n  optionNames: View::optionNames.concat ['renderItems', 'itemView']\n\n  constructor: (options) ->\n    # Initialize list for visible items.\n    @visibleItems = []\n\n    super\n\n  # Initialization\n  # --------------\n\n  initialize: (options = {}) ->\n    # Don't call super; the base view's initialize is a no-op.\n\n    # Start observing the collection.\n    @addCollectionListeners()\n\n    # Apply a filter if one provided.\n    @filter options.filterer if options.filterer?\n\n  # Binding of collection listeners.\n  addCollectionListeners: ->\n    @listenTo @collection, 'add', @itemAdded\n    @listenTo @collection, 'remove', @itemRemoved\n    @listenTo @collection, 'reset sort', @itemsReset\n\n  # Rendering\n  # ---------\n\n  # Override View#getTemplateData, dont serialize collection items here.\n  getTemplateData: ->\n    templateData = {length: @collection.length}\n\n    # If the collection is a SyncMachine, add a `synced` flag.\n    if typeof @collection.isSynced is 'function'\n      templateData.synced = @collection.isSynced()\n\n    templateData\n\n  # In contrast to normal views, a template is not mandatory\n  # for CollectionViews. Provide an empty `getTemplateFunction`.\n  getTemplateFunction: ->\n\n  # Main render method (should be called only once)\n  render: ->\n    super\n\n    # Set the $list property with the actual list container.\n    @list = @el\n\n    @initFallback()\n    @initLoadingIndicator()\n\n    # Render all items.\n    @renderAllItems() if @renderItems\n\n  # Adding / Removing\n  # -----------------\n\n  # When an item is added, create a new view and insert it.\n  itemAdded: (item, collection, options) =>\n    @insertView item, @renderItem(item), options.at\n\n  # When an item is removed, remove the corresponding view from DOM and caches.\n  itemRemoved: (item) =>\n    @removeViewForItem item\n\n  # When all items are resetted, render all anew.\n  itemsReset: =>\n    @renderAllItems()\n\n  # Fallback message when the collection is empty\n  # ---------------------------------------------\n\n  initFallback: ->\n    return unless @fallbackSelector\n\n    # Set the $fallback property.\n    if $\n      @$fallback = @$ @fallbackSelector\n    else\n      @fallback = @find @fallbackSelector\n\n    # Listen for visible items changes.\n    @on 'visibilityChange', @toggleFallback\n\n    # Listen for sync events on the collection.\n    @listenTo @collection, 'syncStateChange', @toggleFallback\n\n    # Set visibility initially.\n    @toggleFallback()\n\n  # Show fallback if no item is visible and the collection is synced.\n  toggleFallback: =>\n    visible = @visibleItems.length is 0 and (\n      if typeof @collection.isSynced is 'function'\n        # Collection is a SyncMachine.\n        @collection.isSynced()\n      else\n        # Assume it is synced.\n        true\n    )\n    toggleElement (if $ then @$fallback else @fallback), visible\n\n  # Loading indicator\n  # -----------------\n\n  initLoadingIndicator: ->\n    # The loading indicator only works for Collections\n    # which are SyncMachines.\n    return unless @loadingSelector and\n      typeof @collection.isSyncing is 'function'\n\n    # Set the $loading property.\n    if $\n      @$loading = @$ @loadingSelector\n    else\n      @loading = @find @loadingSelector\n\n    # Listen for sync events on the collection.\n    @listenTo @collection, 'syncStateChange', @toggleLoadingIndicator\n\n    # Set visibility initially.\n    @toggleLoadingIndicator()\n\n  toggleLoadingIndicator: ->\n    # Only show the loading indicator if the collection is empty.\n    # Otherwise loading more items in order to append them would\n    # show the loading indicator. If you want the indicator to\n    # show up in this case, you need to overwrite this method to\n    # disable the check.\n    visible = @collection.length is 0 and @collection.isSyncing()\n    toggleElement (if $ then @$loading else @loading), visible\n\n  # Filtering\n  # ---------\n\n  # Filters only child item views from all current subviews.\n  getItemViews: ->\n    itemViews = {}\n    if @subviews.length > 0\n      for name, view of @subviewsByName when name.slice(0, 9) is 'itemView:'\n        itemViews[name.slice(9)] = view\n    itemViews\n\n  # Applies a filter to the collection view.\n  # Expects an iterator function as first parameter\n  # which need to return true or false.\n  # Optional filter callback which is called to\n  # show/hide the view or mark it otherwise as filtered.\n  filter: (filterer, filterCallback) ->\n    # Save the filterer and filterCallback functions.\n    if typeof filterer is 'function' or filterer is null\n      @filterer = filterer\n    if typeof filterCallback is 'function' or filterCallback is null\n      @filterCallback = filterCallback\n\n    hasItemViews = do =>\n      if @subviews.length > 0\n        for name of @subviewsByName when name.slice(0, 9) is 'itemView:'\n          return true\n      false\n\n    # Show/hide existing views.\n    if hasItemViews\n      for item, index in @collection.models\n\n        # Apply filter to the item.\n        included = if typeof @filterer is 'function'\n          @filterer item, index\n        else\n          true\n\n        # Show/hide the view accordingly.\n        view = @subview \"itemView:#{item.cid}\"\n        # A view has not been created for this item yet.\n        unless view\n          throw new Error 'CollectionView#filter: ' +\n            \"no view found for #{item.cid}\"\n\n        # Show/hide or mark the view accordingly.\n        @filterCallback view, included\n\n        # Update visibleItems list, but do not trigger an event immediately.\n        @updateVisibleItems view.model, included, false\n\n    # Trigger a combined `visibilityChange` event.\n    @trigger 'visibilityChange', @visibleItems\n\n  # Item view rendering\n  # -------------------\n\n  # Render and insert all items.\n  renderAllItems: =>\n    items = @collection.models\n\n    # Reset visible items.\n    @visibleItems = []\n\n    # Collect remaining views.\n    remainingViewsByCid = {}\n    for item in items\n      view = @subview \"itemView:#{item.cid}\"\n      if view\n        # View remains.\n        remainingViewsByCid[item.cid] = view\n\n    # Remove old views of items not longer in the list.\n    for own cid, view of @getItemViews() when cid not of remainingViewsByCid\n      # Remove the view.\n      @removeSubview \"itemView:#{cid}\"\n\n    # Re-insert remaining items; render and insert new items.\n    for item, index in items\n      # Check if view was already created.\n      view = @subview \"itemView:#{item.cid}\"\n      if view\n        # Re-insert the view.\n        @insertView item, view, index, false\n      else\n        # Create a new view, render and insert it.\n        @insertView item, @renderItem(item), index\n\n    # If no view was created, trigger `visibilityChange` event manually.\n    @trigger 'visibilityChange', @visibleItems if items.length is 0\n\n  # Instantiate and render an item using the `viewsByCid` hash as a cache.\n  renderItem: (item) ->\n    # Get the existing view.\n    view = @subview \"itemView:#{item.cid}\"\n\n    # Instantiate a new view if necessary.\n    unless view\n      view = @initItemView item\n      # Save the view in the subviews.\n      @subview \"itemView:#{item.cid}\", view\n\n    # Render in any case.\n    view.render()\n\n    view\n\n  # Returns an instance of the view class. Override this\n  # method to use several item view constructors depending\n  # on the model type or data.\n  initItemView: (model) ->\n    if @itemView\n      new @itemView {autoRender: false, model}\n    else\n      throw new Error 'The CollectionView#itemView property ' +\n        'must be defined or the initItemView() must be overridden.'\n\n  # Inserts a view into the list at the proper position.\n  insertView: (item, view, position) ->\n\n    # Get the insertion offset if not given.\n    unless typeof position is 'number'\n      position = @collection.indexOf item\n\n    # Is the item included in the filter?\n    included = if typeof @filterer is 'function'\n      @filterer item, position\n    else\n      true\n\n    # Get the views top element.\n    elem = if $ then view.$el else view.el\n\n\n    # Hide or mark the view if its filtered.\n    @filterCallback view, included if @filterer\n\n    length = @collection.length\n\n    # Insert the view into the list.\n    list = if $ then @$list else @list\n\n    insertView list, elem, position, length, @itemSelector\n\n    # Tell the view that it was added to its parent.\n    view.trigger 'addedToParent'\n\n    # Update the list of visible items, trigger a `visibilityChange` event.\n    @updateVisibleItems item, included\n\n    view\n\n  # Remove the view for an item.\n  removeViewForItem: (item) ->\n    # Remove item from visibleItems list, trigger a `visibilityChange` event.\n    @updateVisibleItems item, false\n    @removeSubview \"itemView:#{item.cid}\"\n\n  # List of visible items\n  # ---------------------\n\n  # Update visibleItems list and trigger a `visibilityChanged` event\n  # if an item changed its visibility.\n  updateVisibleItems: (item, includedInFilter, triggerEvent = true) ->\n    visibilityChanged = false\n\n    visibleItemsIndex = @visibleItems.indexOf(item)\n    includedInVisibleItems = visibleItemsIndex isnt -1\n\n    if includedInFilter and not includedInVisibleItems\n      # Add item to the visible items list.\n      @visibleItems.push item\n      visibilityChanged = true\n    else if not includedInFilter and includedInVisibleItems\n      # Remove item from the visible items list.\n      @visibleItems.splice visibleItemsIndex, 1\n      visibilityChanged = true\n\n    # Trigger a `visibilityChange` event if the visible items changed.\n    if visibilityChanged and triggerEvent\n      @trigger 'visibilityChange', @visibleItems\n\n    visibilityChanged\n\n  # Disposal\n  # --------\n\n  dispose: ->\n    return if @disposed\n\n    # Remove jQuery objects, item view cache and visible items list.\n    properties = ['$list', '$fallback', '$loading', 'visibleItems']\n    delete this[prop] for prop in properties\n\n    # Self-disposal.\n    super","View     = require './view'\n\nmodule.exports = class DJ extends View\n  audio: {}\n  currentTrack: 'soundtrack'\n  isPlaying: false\n  tracks:\n    'soundtrack': 'https://s3.amazonaws.com/cremalab/bit-shifter-let-it-snow.mp3'\n    'disco'     : 'https://s3.amazonaws.com/cremalab/disco.mp3'\n  trackVolumes:\n    'soundtrack': 0.1\n    'disco': 1.0\n\n  initialize: ->\n    for track in Object.keys @tracks\n      @audio[track] = new Audio(@tracks[track])\n      @audio[track].loop = true\n      @audio[track].volume = @trackVolumes[track]\n    @playTrack(@currentTrack)\n\n  playTrack: (track) ->\n    @audio[@currentTrack].pause()\n    unless @isPlaying is false\n      @audio[track].play()\n    @currentTrack = track\n\n  togglePlayback: ->\n    if @isPlaying\n      @audio[@currentTrack].pause()\n      @isPlaying = false\n    else\n      @audio[@currentTrack].play()\n      @isPlaying = true\n","View = require './view'\n\nmodule.exports = class DrawingCanvas extends View\n  color: \"#363f59\"\n  lineWidth: 50\n  gameLoopInt: 2000\n  plotCleanCount: 5\n  cleanup: false\n\n  initialize: ->\n    super\n    @plots = []\n    if @cleanup\n      setInterval =>\n        @cleanupPlots()\n      , @gameLoopInt\n\n  render: ->\n    super\n    @ctx = @el.getContext('2d')\n    @ctx.globalAlpha = 0.5\n    @ctx.globalCompositeOperation = \"xor\"\n    @ctx.strokeStyle = @color\n    @ctx.lineWidth = @lineWidth\n    @ctx.lineCap = 'round'\n    @ctx.lineJoin = 'round'\n\n  drawOnCanvas: (plots) ->\n    if plots.length\n      @ctx.beginPath()\n      @ctx.moveTo plots[0].x, plots[0].y\n      for plot, i in plots\n        @ctx.lineTo plot.x, plot.y\n      @ctx.stroke()\n      # @ctx.closePath()\n\n  # Extend an avatar's trail\n  addPointToTrail: (plots, player, avatar) ->\n    start = plots[0]\n    end   = plots[plots.length-1]\n\n    @ctx.beginPath()\n    @ctx.moveTo start.x, start.y\n    @ctx.lineTo end.x, end.y\n    @ctx.stroke()\n    @ctx.closePath()\n    @plots.push start\n    @plots.push end\n\n  # Drop old snow trail plots and redraw\n  cleanupPlots: ->\n    @plots.splice(0, @plotCleanCount)\n    @ctx.restore()\n    @ctx.clearRect(0,0, @el.width, @el.height)\n    @drawOnCanvas(@plots)\n\n","JoinGameView = require 'views/join_game_view'\n\nmodule.exports = class EditAvatarView extends JoinGameView\n  noClose: false\n  render: ->\n    super\n    @bindForm()\n    @el.querySelector('button').innerText = \"Save Avatar\"\n\n  bindForm: ->\n    for attribute in Object.keys(@model.attributes)\n      val = @model.get(attribute)\n      input = @el.querySelector(\"input[name='#{attribute}']\")\n      if input\n        if input.type is 'radio'\n          input = @el.querySelector(\"input[name='#{attribute}'][value='#{val}']\")\n          if input\n            input.checked = true\n        else\n          input.value = val","View = require './view'\ntemplate = require './templates/hint'\n\nmodule.exports = class HintView extends View\n  className: 'hint'\n  template: template\n  y_offset: 10\n  x_offset: 10\n  initialize: ->\n    super\n    @listenTo @model, 'dispose', @dispose\n  render: ->\n    super\n    setTimeout =>\n      @el.style.position = 'absolute'\n      rect = @el.getBoundingClientRect()\n      obstruction = @model.get('obstruction')\n      @el.style.zIndex = obstruction.bottom\n      ob_width = obstruction.right - obstruction.left\n      if @model.get('position') and @model.get('position') is 'right'\n        @el.style.left = (obstruction.x + ob_width + @x_offset) + \"px\"\n        @el.style.top = (@model.get('obstruction').y - @y_offset) + \"px\"\n      else\n        @el.style.left = (obstruction.x - (rect.width/4) ) + \"px\"\n        @el.style.top = (@model.get('obstruction').y - (rect.height + @y_offset)) + \"px\"\n    , 0","Modal     = require 'views/modal_view'\ntemplate = require './templates/intro'\n\nmodule.exports = class IntroView extends Modal\n  template: template\n  autoRender: true\n  className: 'modal sub-intro'\n  triggerVolume: true\n\n  initialize: (options) ->\n    if options.triggerVolume is false\n      @triggerVolume = false\n    super\n\n  render: ->\n    super\n    thing = @el.querySelector('button')\n    thing.addEventListener 'click', =>\n      @dispose()\n\n  dispose: ->\n    @trigger 'dispose'\n    if @triggerVolume\n      @publishEvent('togglePlayback')\n    super\n\n","Modal     = require './modal_view'\nAvatar   = require 'views/avatar'\nmediator = require 'lib/mediator'\ntemplate = require './templates/join_game'\n\nmodule.exports = class JoinGameView extends Modal\n  template: template\n  autoRender: true\n  tagName: 'form'\n  noClose: true\n\n  render: ->\n    super\n    radios = @el.querySelectorAll(\"input[type='radio']\")\n    mediator.game_state = 'modal'\n\n    @avatarView = new Avatar\n      model: @model\n      soulless: true\n      container: @el.querySelector('.avatar-holder')\n      autoRender: true\n\n    for radio in radios\n      radio.addEventListener 'change', (e) =>\n        name = e.target.name\n        val  = @el.querySelector(\"input[name='#{name}']:checked\").value\n        @model.set(name, val)\n\n    @el.addEventListener 'submit', (e) =>\n      e.preventDefault()\n      e.stopPropagation()\n      @trigger('setPlayerName', document.getElementById('player_name').value)\n\n  dispose: ->\n    mediator.game_state = 'playing'\n    @avatarView.dispose()\n    super\n","Landscaper = require 'lib/landscaper'\nView       = require './view'\ntemplate   = require './templates/map'\ntransition_events = 'transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd'\n\nmodule.exports = class MapView extends View\n  template: template\n  className: \"map\"\n  viewport_padding: 300\n  offset_x: 0\n  offset_y: 0\n  width: 2002\n  height: 1500\n  padding_top: 80\n  padding_bottom: 15\n\n  initialize: ->\n    super\n    if !!(\"ontouchstart\" of window) or !!(\"onmsgesturechange\" of window)\n      @mobile = true\n    @landscaper = new Landscaper\n      map: @\n    @subscribeEvent 'map:pan_to_player', @panToPlayerPosition\n\n  render: ->\n    super\n    @setDimensions()\n    @landscaper.init()\n    window.addEventListener 'resize', =>\n      @setDimensions()\n\n    # prevent double-tap zoon\n    doubleTouchStartTimestamp = 0\n    document.addEventListener \"touchstart\", (event) ->\n      now = +(new Date())\n      event.preventDefault()  if doubleTouchStartTimestamp + 500 > now\n      doubleTouchStartTimestamp = now\n      return\n\n    if @mobile\n      document.body.removeChild document.getElementById(\"keysHints\")\n\n\n\n  setDimensions: ->\n    @rect = document.body.getClientRects()[0]\n    if @mobile\n      @viewport_padding = \n        x: @rect.width * 0.5\n        y: @rect.height * 0.45\n    else\n      @viewport_padding = \n        x: @rect.width * 0.3\n        y: @rect.height * 0.3\n    @sidebarWidth = document.body.querySelector('.sidebar').getClientRects()[0].width\n    @viewport =\n      left:   @rect.left + @viewport_padding.x - @sidebarWidth\n      top:    @rect.top + @viewport_padding.y\n      right:  @rect.right - @viewport_padding.x\n      bottom: @rect.bottom - @viewport_padding.y\n\n\n  spawnPlayer: (player, avatar) ->\n    avatar.container = @el\n    avatar.render()\n    setTimeout =>\n      @checkPlayerPosition(player, avatar)\n    , 0\n\n  checkPlayerPosition: (px,py,avatar) ->\n    @canMoveTo(px, py, avatar)\n\n    within_x = px > @viewport.left and px < @viewport.right\n    within_y = py > @viewport.top and py < @viewport.bottom\n    within_rect = within_x and within_y\n    if avatar\n      @panToPlayerPosition(avatar.model, avatar) if avatar.model.isCurrentPlayer()\n\n  panToPlayerPosition: (player, avatar, animate) ->\n    @focusedPlayer = player\n\n    px = player.get('x_position')\n    py = player.get('y_position')\n\n    a_height = avatar.height or 0\n    a_width = avatar.width or 0\n\n    pan_right = px > ((@viewport.right - @offset_x) - a_width)\n    pan_left  = px < (@viewport.left - @offset_x)\n    pan_down  = py > ((@viewport.bottom - @offset_y) - a_height)\n    pan_up    = py < (@viewport.top - @offset_y)\n\n    new_x = @offset_x\n    new_y = @offset_y\n\n    if pan_left\n      new_x = @rect.left + (@viewport.left - px)\n    if pan_right\n      new_x = @rect.left + ((@viewport.right - avatar.width) - px)\n    if pan_up\n      new_y = @rect.top + (@viewport.top - py)\n    if pan_down\n      new_y = @rect.top + ((@viewport.bottom - a_height) - py)\n\n    # Don't pan if it will reveal beyond the edge of the map\n    left_max_pan   = @offset_x - (@viewport_padding.x - a_width)\n\n    unless (new_x + @offset_x) >= 0 or Math.abs(px + @viewport_padding.x) >= @width\n      @offset_x = new_x\n    unless (new_y + @offset_y) >= 0 or Math.abs(py + @viewport_padding.y) >= @height\n      @offset_y = new_y\n\n    @repositionMap(parseInt(@offset_x), parseInt(@offset_y), animate)\n\n  centerMapOn: (x, y, offset_x, offset_y) ->\n    viewportCenterX = @viewport.right/2\n    viewportCenterY = @viewport.bottom/2\n\n    @offset_x = @offset_x - (x - viewportCenterX - 150) # minus sidebar width\n    @offset_y = @offset_y - (y - viewportCenterY)\n    if Math.abs(@offset_y - (y - viewportCenterY)) >= @height\n      @offset_y = -(y - @viewport.bottom - (@viewport_padding.y/1.6))\n\n    if Math.abs(@offset_x - (x - viewportCenterX)) >= @width\n      @offset_x = -(x - @viewport.right - (@viewport_padding.x/1.6))\n    \n    @repositionMap(parseInt(@offset_x), parseInt(@offset_y))\n\n\n  repositionMap: (left, top, animate) ->\n    if animate\n      @el.addEventListener \"transitionend\", @removeTransition, @\n      @el.style.transition = 'all .5s'\n    @el.style.webkitTransform = \"translate3d(#{left}px, #{top}px, 0)\"\n    @el.style.MozTransform = \"translate3d(#{left}px, #{top}px, 0)\"\n\n  removeTransition: ->\n    @style.transition = null\n    @removeEventListener('transitionend', @addAnimation)\n\n  canMoveTo: (x,y, avatar) ->\n    if avatar\n      @landscaper.checkObstructions x,y,avatar,@\n\n  addTouchEvents: (avatar, event_name) ->\n    @el.addEventListener event_name, (e) =>\n      avatar.stopMovement()\n      x = e.touches[0].clientX - @sidebarWidth - (avatar.width /2)\n      y = e.touches[0].clientY - (avatar.height/2)\n      @publishEvent 'map:interact', e, x, y\n      avatar.travelToPoint(x,y)\n","View     = require 'views/view'\nmediator = require 'lib/mediator'\ntemplate = require './templates/modal'\n\nmodule.exports = class ModalView extends View\n  template: template\n  className: 'modal'\n  initialize: (options) ->\n    if options and options.template\n      @template = options.template\n    super\n  render: ->\n    super\n    mediator.game_state = 'modal'\n    unless @noClose\n      @closeButton = document.createElement 'a'\n      @el.querySelector('.modal-content-box').appendChild(@closeButton)\n      @closeButton.setAttribute('href', '#')\n      @closeButton.className = 'close icon-close'\n      @closeButton.addEventListener 'click', =>\n        @dispose()\n\n      window.addEventListener 'keyup', @checkEsc\n        \n\n  checkEsc: (e) =>\n    if e.keyCode is 27\n      e.stopPropagation()\n      return @dispose()\n\n  dispose: ->\n    mediator.game_state = 'playing'\n    window.removeEventListener 'keyup', @checkEsc\n    super","CollectionView = require './collection_view'\nAvatar = require './avatar'\n\n\nmodule.exports = class PlayerList extends CollectionView\n  className: 'playerList'\n  initItemView: (model) ->\n    if model.isCurrentPlayer()\n      template = require './templates/avatar'\n    else\n      template = require './templates/avatar_head'\n\n    avatar = new Avatar\n      model: model\n      soulless: true\n      template: template\n    avatar.el.addEventListener 'click', =>\n      @publishEvent \"map:pan_to_player\", model, avatar, true\n    return avatar","View     = require 'views/view'\ntemplate = require './templates/speech_bubble'\n\nmodule.exports = class SpeechBubbleView extends View\n  className: \"speech-bubble\"\n  template: template\n\n  initialize: (options) ->\n    super\n    @chatterBox = options.chatterBox\n    @avatar     = options.avatar\n\n  render: ->\n    super\n    if @avatar.model.isCurrentPlayer()\n      @el.querySelector('.close').addEventListener 'click', (e) =>\n        e.stopPropagation()\n        e.preventDefault()\n        @chatterBox.disposeBubble(true)\n      @el.querySelector('.close').addEventListener 'touchstart', (e) =>\n        e.stopPropagation()\n        e.preventDefault()\n        @chatterBox.disposeBubble(true)\n    else\n      @el.removeChild(@el.querySelector('.close'))","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar locals_ = (locals || {}),name = locals_.name;\nbuf.push(\"<div class=\\\"player-name\\\">\" + (jade.escape(null == (jade.interp = name) ? \"\" : jade.interp)) + \"</div><div class=\\\"avatar-wrap\\\"><div class=\\\"body\\\"><div class=\\\"hat\\\"></div><div class=\\\"head\\\"></div><div class=\\\"hair\\\"></div><div class=\\\"left eye\\\"></div><div class=\\\"right eye\\\"></div><div class=\\\"mouth\\\"></div><div class=\\\"torso\\\"></div><div class=\\\"left leg\\\"></div><div class=\\\"right leg\\\"></div><div class=\\\"right arm\\\"></div><div class=\\\"left arm\\\"></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar locals_ = (locals || {}),name = locals_.name;\nbuf.push(\"<div class=\\\"player-name\\\">\" + (jade.escape(null == (jade.interp = name) ? \"\" : jade.interp)) + \"</div><div class=\\\"avatar-wrap\\\"><div class=\\\"body\\\"><div class=\\\"hat\\\"></div><div class=\\\"head\\\"></div><div class=\\\"hair\\\"></div><div class=\\\"left eye\\\"></div><div class=\\\"right eye\\\"></div><div class=\\\"mouth\\\"></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\n\nbuf.push(\"<div class=\\\"modal-wrap\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-content-box\\\"><img src=\\\"party/images/bathroom_photo.jpg\\\"/></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\n\nbuf.push(\"<input type=\\\"text\\\" placeholder=\\\"say something...\\\" name=\\\"chat_text\\\" autofocus=\\\"autofocus\\\" onFocus=\\\"window.scrollTo(0, 0);\\\" autocomplete=\\\"off\\\"/>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar locals_ = (locals || {}),text = locals_.text;\nbuf.push(jade.escape(null == (jade.interp = text) ? \"\" : jade.interp));;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\n\nbuf.push(\"<div class=\\\"modal-wrap\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-content-box\\\"><div class=\\\"intro\\\"><div class=\\\"intro-logo\\\"><img src=\\\"party/images/crema-christmas-logo.svg\\\" alt=\\\"Cremalab Christmas Icon\\\"/></div><div class=\\\"intro-script\\\"><img src=\\\"party/images/crema-christmas-script.svg\\\" alt=\\\"Crema-Christmas\\\"/></div><p>Welcome to the Crema-christmas Holiday Party (Virtual Edition)!\\nThis party uses the latest in internet tech, so leave your old\\nbrowsers at the door - and the faster your computer the better\\n(this is the 21st century after all)!</p><p><button class=\\\"sub-bigGreen sub-width-full\\\">Let's Party!</button></p><p>Built using these fine services and tools:</p><div class=\\\"services grid align-middle spaced\\\"><div class=\\\"grid-items\\\"><div class=\\\"service sub-pubnub col\\\"><a href=\\\"http://www.pubnub.com\\\" target=\\\"_blank\\\"><img src=\\\"party/images/logo-pubnub.svg\\\" alt=\\\"PubNub\\\"/></a></div><div class=\\\"service sub-brunch col\\\"><a href=\\\"http://brunch.io\\\" target=\\\"_blank\\\"><img src=\\\"party/images/logo-brunch.svg\\\" alt=\\\"Brunch\\\"/></a></div><div class=\\\"service sub-github col\\\"><a href=\\\"https://github.com\\\" target=\\\"_blank\\\"><img src=\\\"party/images/logo-github.svg\\\" alt=\\\"Github\\\"/></a></div></div></div><p class=\\\"tiny\\\">* best on Modern Browsers &amp; fast computers</p></div></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\n\nvar genders      = [ 'male', 'female' ]\nvar hat_colors   = [ '0', '1', '2', '3', '4', '5', '6', '7', '8']\nvar hair_colors  = [ '0', '1', '2', '3', '4' ]\nvar skin_colors  = [ '0', '1', '2', '3', '4' ]\nvar hat_colors   = [ '0', '1', '2', '3', '4', '5', '6', '7', '8']\nvar pants_colors = [ '0', '1', '2', '3', '4' ]\nbuf.push(\"<div class=\\\"modal-wrap\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-content-box\\\"><form><h2>Customize Avatar</h2><input id=\\\"player_name\\\" name=\\\"name\\\" type=\\\"text\\\" placeholder=\\\"What's your name?\\\"/><div class=\\\"grid spaced align-middle break-max-medium\\\"><div class=\\\"grid-items\\\"><div class=\\\"col\\\"><div class=\\\"field sub-colorPicker\\\"><div class=\\\"grid align-middle spaced break-max-medium\\\"><div class=\\\"grid-items\\\"><div class=\\\"row\\\"><div class=\\\"col\\\"><div class=\\\"field-label\\\">Gender:</div></div><div class=\\\"col\\\"><div class=\\\"field-input\\\"><div class=\\\"colorPicker\\\">\");\n// iterate genders\n;(function(){\n  var $$obj = genders;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var gender = $$obj[$index];\n\nvar pickerId = \"avatar-gender\"\nbuf.push(\"<input type=\\\"radio\\\"\" + (jade.attr(\"name\", pickerId, true, false)) + (jade.attr(\"value\", gender, true, false)) + (jade.attr(\"id\", pickerId + \"-\" + gender, true, false)) + \"/><label\" + (jade.attr(\"for\", pickerId + \"-\" + gender, true, false)) + (jade.cls([pickerId + \"-\" + gender], [true])) + \">\" + (jade.escape(null == (jade.interp = gender) ? \"\" : jade.interp)) + \"</label>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var gender = $$obj[$index];\n\nvar pickerId = \"avatar-gender\"\nbuf.push(\"<input type=\\\"radio\\\"\" + (jade.attr(\"name\", pickerId, true, false)) + (jade.attr(\"value\", gender, true, false)) + (jade.attr(\"id\", pickerId + \"-\" + gender, true, false)) + \"/><label\" + (jade.attr(\"for\", pickerId + \"-\" + gender, true, false)) + (jade.cls([pickerId + \"-\" + gender], [true])) + \">\" + (jade.escape(null == (jade.interp = gender) ? \"\" : jade.interp)) + \"</label>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div></div></div></div><div class=\\\"row\\\"><div class=\\\"col\\\"><div class=\\\"field-label\\\">Hat:</div></div><div class=\\\"col\\\"><div class=\\\"field-input\\\"><div class=\\\"colorPicker\\\">\");\n// iterate hat_colors\n;(function(){\n  var $$obj = hat_colors;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var color = $$obj[$index];\n\nvar pickerId = \"avatar-hat\"\nbuf.push(\"<input type=\\\"radio\\\"\" + (jade.attr(\"name\", pickerId, true, false)) + (jade.attr(\"value\", pickerId + \"-\" + color, true, false)) + (jade.attr(\"id\", pickerId + \"-\" + color, true, false)) + \"/><label\" + (jade.attr(\"for\", pickerId + \"-\" + color, true, false)) + (jade.cls([pickerId + \"-\" + color], [true])) + \"></label>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var color = $$obj[$index];\n\nvar pickerId = \"avatar-hat\"\nbuf.push(\"<input type=\\\"radio\\\"\" + (jade.attr(\"name\", pickerId, true, false)) + (jade.attr(\"value\", pickerId + \"-\" + color, true, false)) + (jade.attr(\"id\", pickerId + \"-\" + color, true, false)) + \"/><label\" + (jade.attr(\"for\", pickerId + \"-\" + color, true, false)) + (jade.cls([pickerId + \"-\" + color], [true])) + \"></label>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div></div></div></div><div class=\\\"row\\\"><div class=\\\"col\\\"><div class=\\\"field-label\\\">Hair:</div></div><div class=\\\"col\\\"><div class=\\\"field-input\\\"><div class=\\\"colorPicker\\\">\");\n// iterate hair_colors\n;(function(){\n  var $$obj = hair_colors;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var color = $$obj[$index];\n\nvar pickerId = \"avatar-hair\"\nbuf.push(\"<input type=\\\"radio\\\"\" + (jade.attr(\"name\", pickerId, true, false)) + (jade.attr(\"value\", pickerId + \"-\" + color, true, false)) + (jade.attr(\"id\", pickerId + \"-\" + color, true, false)) + \"/><label\" + (jade.attr(\"for\", pickerId + \"-\" + color, true, false)) + (jade.cls([pickerId + \"-\" + color], [true])) + \"></label>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var color = $$obj[$index];\n\nvar pickerId = \"avatar-hair\"\nbuf.push(\"<input type=\\\"radio\\\"\" + (jade.attr(\"name\", pickerId, true, false)) + (jade.attr(\"value\", pickerId + \"-\" + color, true, false)) + (jade.attr(\"id\", pickerId + \"-\" + color, true, false)) + \"/><label\" + (jade.attr(\"for\", pickerId + \"-\" + color, true, false)) + (jade.cls([pickerId + \"-\" + color], [true])) + \"></label>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div></div></div></div><div class=\\\"row\\\"><div class=\\\"col\\\"><div class=\\\"field-label\\\">Skin:</div></div><div class=\\\"col\\\"><div class=\\\"field-input\\\"><div class=\\\"colorPicker\\\">\");\n// iterate skin_colors\n;(function(){\n  var $$obj = skin_colors;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var color = $$obj[$index];\n\nvar pickerId = \"avatar-skin\"\nbuf.push(\"<input type=\\\"radio\\\"\" + (jade.attr(\"name\", pickerId, true, false)) + (jade.attr(\"value\", pickerId + \"-\" + color, true, false)) + (jade.attr(\"id\", pickerId + \"-\" + color, true, false)) + \"/><label\" + (jade.attr(\"for\", pickerId + \"-\" + color, true, false)) + (jade.cls([pickerId + \"-\" + color], [true])) + \"></label>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var color = $$obj[$index];\n\nvar pickerId = \"avatar-skin\"\nbuf.push(\"<input type=\\\"radio\\\"\" + (jade.attr(\"name\", pickerId, true, false)) + (jade.attr(\"value\", pickerId + \"-\" + color, true, false)) + (jade.attr(\"id\", pickerId + \"-\" + color, true, false)) + \"/><label\" + (jade.attr(\"for\", pickerId + \"-\" + color, true, false)) + (jade.cls([pickerId + \"-\" + color], [true])) + \"></label>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div></div></div></div><div class=\\\"row\\\"><div class=\\\"col\\\"><div class=\\\"field-label\\\">Coat:</div></div><div class=\\\"col\\\"><div class=\\\"field-input\\\"><div class=\\\"colorPicker\\\">\");\n// iterate hat_colors\n;(function(){\n  var $$obj = hat_colors;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var color = $$obj[$index];\n\nvar pickerId = \"avatar-coat\"\nbuf.push(\"<input type=\\\"radio\\\"\" + (jade.attr(\"name\", pickerId, true, false)) + (jade.attr(\"value\", pickerId + \"-\" + color, true, false)) + (jade.attr(\"id\", pickerId + \"-\" + color, true, false)) + \"/><label\" + (jade.attr(\"for\", pickerId + \"-\" + color, true, false)) + (jade.cls([pickerId + \"-\" + color], [true])) + \"></label>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var color = $$obj[$index];\n\nvar pickerId = \"avatar-coat\"\nbuf.push(\"<input type=\\\"radio\\\"\" + (jade.attr(\"name\", pickerId, true, false)) + (jade.attr(\"value\", pickerId + \"-\" + color, true, false)) + (jade.attr(\"id\", pickerId + \"-\" + color, true, false)) + \"/><label\" + (jade.attr(\"for\", pickerId + \"-\" + color, true, false)) + (jade.cls([pickerId + \"-\" + color], [true])) + \"></label>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div></div></div></div><div class=\\\"row\\\"><div class=\\\"col\\\"><div class=\\\"field-label\\\">Pants:</div></div><div class=\\\"col\\\"><div class=\\\"field-input\\\"><div class=\\\"colorPicker\\\">\");\n// iterate hat_colors\n;(function(){\n  var $$obj = hat_colors;\n  if ('number' == typeof $$obj.length) {\n\n    for (var $index = 0, $$l = $$obj.length; $index < $$l; $index++) {\n      var color = $$obj[$index];\n\nvar pickerId = \"avatar-pants\"\nbuf.push(\"<input type=\\\"radio\\\"\" + (jade.attr(\"name\", pickerId, true, false)) + (jade.attr(\"value\", pickerId + \"-\" + color, true, false)) + (jade.attr(\"id\", pickerId + \"-\" + color, true, false)) + \"/><label\" + (jade.attr(\"for\", pickerId + \"-\" + color, true, false)) + (jade.cls([pickerId + \"-\" + color], [true])) + \"></label>\");\n    }\n\n  } else {\n    var $$l = 0;\n    for (var $index in $$obj) {\n      $$l++;      var color = $$obj[$index];\n\nvar pickerId = \"avatar-pants\"\nbuf.push(\"<input type=\\\"radio\\\"\" + (jade.attr(\"name\", pickerId, true, false)) + (jade.attr(\"value\", pickerId + \"-\" + color, true, false)) + (jade.attr(\"id\", pickerId + \"-\" + color, true, false)) + \"/><label\" + (jade.attr(\"for\", pickerId + \"-\" + color, true, false)) + (jade.cls([pickerId + \"-\" + color], [true])) + \"></label>\");\n    }\n\n  }\n}).call(this);\n\nbuf.push(\"</div></div></div></div></div></div></div></div><div class=\\\"col nest-reset avatar-holder\\\"></div></div></div><button class=\\\"sub-width-full\\\">Join the party!</button></form></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\n\nbuf.push(\"<div class=\\\"modal-wrap\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-content-box\\\"><h1>You've been kicked.</h1><p>Maybe you were stuck, maybe you were being mean...either way we hope to see you back!</p></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\n\nbuf.push(\"<div id=\\\"content\\\"><canvas id=\\\"drawCanvas\\\" width=\\\"5769\\\" height=\\\"4102\\\"></canvas></div><div class=\\\"disco\\\"><div class=\\\"lights\\\"><div class=\\\"light red\\\"></div><div class=\\\"light yellow\\\"></div><div class=\\\"light green\\\"></div><div class=\\\"light blue\\\"></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\n\nbuf.push(\"<div class=\\\"modal-wrap\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-content-box\\\"></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\nvar locals_ = (locals || {}),content = locals_.content;\nbuf.push((jade.escape(null == (jade.interp = content) ? \"\" : jade.interp)) + \"<a href=\\\"#\\\" class=\\\"close icon-close\\\"></a>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function template(locals) {\nvar buf = [];\nvar jade_mixins = {};\n\nbuf.push(\"<div class=\\\"modal-wrap\\\"><div class=\\\"modal-content\\\"><div class=\\\"modal-content-box\\\"><img src=\\\"party/images/cremacrew_holiday2014.jpg\\\"/></div></div></div>\");;return buf.join(\"\");\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","mediator    = require 'lib/mediator'\nutils       = require 'lib/utils'\nEventBroker = require 'lib/event_broker'\n\n# Shortcut to access the DOM manipulation library.\n$ = Backbone.$\n\n# Function bind shortcut.\nbind = do ->\n  if Function::bind\n    (item, ctx) -> item.bind ctx\n  else if _.bind\n    _.bind\n\nsetHTML = do ->\n  if $\n    (elem, html) -> elem.html html\n  else\n    (elem, html) -> elem.innerHTML = html\n\nattach = do ->\n  if $\n    (view) ->\n      actual = $(view.container)\n      if typeof view.containerMethod is 'function'\n        view.containerMethod actual, view.el\n      else\n        actual[view.containerMethod] view.el\n  else\n    (view) ->\n      actual = if typeof view.container is 'string'\n        document.querySelector view.container\n      else\n        view.container\n\n      if typeof view.containerMethod is 'function'\n        view.containerMethod actual, view.el\n      else\n        actual[view.containerMethod] view.el\n\nmodule.exports = class View extends Backbone.NativeView\n  # Mixin an EventBroker.\n  Backbone.utils.extend @prototype, EventBroker\n\n  # Automatic rendering\n  # -------------------\n\n  # Flag whether to render the view automatically on initialization.\n  # As an alternative you might pass a `render` option to the constructor.\n  autoRender: false\n\n  # Flag whether to attach the view automatically on render.\n  autoAttach: true\n\n  # Automatic inserting into DOM\n  # ----------------------------\n\n  # View container element.\n  # Set this property in a derived class to specify the container element.\n  # Normally this is a selector string but it might also be an element or\n  # jQuery object.\n  # The view is automatically inserted into the container when its rendered.\n  # As an alternative you might pass a `container` option to the constructor.\n  container: null\n\n  # Method which is used for adding the view to the DOM\n  # Like jQuerys `html`, `prepend`, `append`, `after`, `before` etc.\n  containerMethod: if $ then 'append' else 'appendChild'\n\n  # Regions\n  # -------\n\n  # Region registration; regions are in essence named selectors that aim\n  # to decouple the view from its parent.\n  #\n  # This functions close to the declarative events hash; use as follows:\n  # regions:\n  #   'region1': '.class'\n  #   'region2': '#id'\n  regions: null\n\n  # Region application is the reverse; you're specifying that this view\n  # will be inserted into the DOM at the named region. Error thrown if\n  # the region is unregistered at the time of initialization.\n  # Set the region name on your derived class or pass it into the\n  # constructor in controller action.\n  region: null\n\n  # A view is `stale` when it has been previously composed by the last\n  # route but has not yet been composed by the current route.\n  stale: false\n\n  # Flag whether to wrap a view with the `tagName` element when\n  # rendering into a region.\n  noWrap: false\n\n  # Specifies if current element should be kept in DOM after disposal.\n  keepElement: false\n\n  # Subviews\n  # --------\n\n  # List of subviews.\n  subviews: null\n  subviewsByName: null\n\n  # Initialization\n  # --------------\n\n  # List of options that will be picked from constructor.\n  # Easy to extend: `optionNames: View::optionNames.concat ['template']`\n  optionNames: [\n    'autoAttach', 'autoRender',\n    'container', 'containerMethod',\n    'region', 'regions'\n    'noWrap'\n  ]\n\n  constructor: (options) ->\n    # Copy some options to instance properties.\n    if options\n      for optName, optValue of options when optName in @optionNames\n        this[optName] = optValue\n\n    # Wrap `render` so `attach` is called afterwards.\n    # Enclose the original function.\n    render = @render\n    # Create the wrapper method.\n    @render = =>\n      # Stop if the instance was already disposed.\n      return false if @disposed\n      # Call the original method.\n      render.apply this, arguments\n      # Attach to DOM.\n      @attach arguments... if @autoAttach\n      # Return the view.\n      this\n\n    # Initialize subviews collections.\n    @subviews = []\n    @subviewsByName = {}\n\n    if @noWrap\n      if @region\n        region = mediator.execute 'region:find', @region\n        # Set the `this.el` to be the closest relevant container.\n        if region?\n          @el =\n            if region.instance.container?\n              if region.instance.region?\n                $(region.instance.container).find region.selector\n              else\n                region.instance.container\n            else\n              region.instance.$ region.selector\n\n      @el = @container if @container\n\n    # Call Backbones constructor.\n    super\n\n    # Set up declarative bindings after `initialize` has been called\n    # so initialize may set model/collection and create or bind methods.\n    @delegateListeners()\n\n    # Listen for disposal of the model or collection.\n    # If the model is disposed, automatically dispose the associated view.\n    @listenTo @model, 'dispose', @dispose if @model\n    if @collection\n      @listenTo @collection, 'dispose', (subject) =>\n        @dispose() if not subject or subject is @collection\n\n    # Register all exposed regions.\n    mediator.execute 'region:register', this if @regions?\n\n    # Render automatically if set by options or instance property.\n    @render() if @autoRender\n\n  # User input event handling\n  # -------------------------\n\n  # Event handling using event delegation\n  # Register a handler for a specific event type\n  # For the whole view:\n  #   delegate(eventName, handler)\n  #   e.g.\n  #   @delegate('click', @clicked)\n  # For an element in the passing a selector:\n  #   delegate(eventName, selector, handler)\n  #   e.g.\n  #   @delegate('click', 'button.confirm', @confirm)\n  delegate: (eventName, second, third) ->\n    if Backbone.utils\n      return Backbone.utils.delegate(this, eventName, second, third)\n    if typeof eventName isnt 'string'\n      throw new TypeError 'View#delegate: first argument must be a string'\n\n    if arguments.length is 2\n      handler = second\n    else if arguments.length is 3\n      selector = second\n      if typeof selector isnt 'string'\n        throw new TypeError 'View#delegate: ' +\n          'second argument must be a string'\n      handler = third\n    else\n      throw new TypeError 'View#delegate: ' +\n        'only two or three arguments are allowed'\n\n    if typeof handler isnt 'function'\n      throw new TypeError 'View#delegate: ' +\n        'handler argument must be function'\n\n    # Add an event namespace, bind handler it to view.\n    list = (\"#{event}.delegate#{@cid}\" for event in eventName.split ' ')\n    events = list.join(' ')\n    bound = bind handler, this\n    @$el.on events, (selector or null), bound\n\n    # Return the bound handler.\n    bound\n\n  # Copy of original Backbone method without `undelegateEvents` call.\n  _delegateEvents: (events) ->\n    if Backbone.View::delegateEvents.length is 2\n      return Backbone.View::delegateEvents.call this, events, true\n    for key, value of events\n      handler = if typeof value is 'function' then value else this[value]\n      throw new Error \"Method '#{value}' does not exist\" unless handler\n      match = key.match /^(\\S+)\\s*(.*)$/\n      eventName = \"#{match[1]}.delegateEvents#{@cid}\"\n      selector = match[2]\n      bound = bind handler, this\n      @$el.on eventName, (selector or null), bound\n    return\n\n  # Override Backbones method to combine the events\n  # of the parent view if it exists.\n  delegateEvents: (events, keepOld) ->\n    @undelegateEvents() unless keepOld\n    return @_delegateEvents events if events\n    # Call _delegateEvents for all superclasses `events`.\n    for classEvents in utils.getAllPropertyVersions this, 'events'\n      classEvents = classEvents.call this if typeof classEvents is 'function'\n      @_delegateEvents classEvents\n    return\n\n  # Remove all handlers registered with @delegate.\n  undelegate: (eventName, second, third) ->\n    if Backbone.utils\n      return Backbone.utils.undelegate(this, eventName, second, third)\n    if eventName\n      if typeof eventName isnt 'string'\n        throw new TypeError 'View#undelegate: first argument must be a string'\n\n      if arguments.length is 2\n        if typeof second is 'string'\n          selector = second\n        else\n          handler = second\n      else if arguments.length is 3\n        selector = second\n        if typeof selector isnt 'string'\n          throw new TypeError 'View#undelegate: ' +\n            'second argument must be a string'\n        handler = third\n\n      list = (\"#{event}.delegate#{@cid}\" for event in eventName.split ' ')\n      events = list.join(' ')\n      @$el.off events, (selector or null)\n    else\n      @$el.off \".delegate#{@cid}\"\n\n  # Handle declarative event bindings from `listen`\n  delegateListeners: ->\n    return unless @listen\n\n    # Walk all `listen` hashes in the prototype chain.\n    for version in utils.getAllPropertyVersions this, 'listen'\n      version = version.call this if typeof version is 'function'\n      for key, method of version\n        # Get the method, ensure it is a function.\n        if typeof method isnt 'function'\n          method = this[method]\n        if typeof method isnt 'function'\n          throw new Error 'View#delegateListeners: ' +\n            \"listener for \\\"#{key}\\\" must be function\"\n\n        # Split event name and target.\n        [eventName, target] = key.split ' '\n        @delegateListener eventName, target, method\n\n    return\n\n  delegateListener: (eventName, target, callback) ->\n    if target in ['model', 'collection']\n      prop = this[target]\n      @listenTo prop, eventName, callback if prop\n    else if target is 'mediator'\n      @subscribeEvent eventName, callback\n    else if not target\n      @on eventName, callback, this\n\n    return\n\n  # Subviews\n  # --------\n\n  # Getting or adding a subview.\n  subview: (name, view) ->\n    # Initialize subviews collections if they dont exist yet.\n    subviews = @subviews\n    byName = @subviewsByName\n\n    if name and view\n      # Add the subview, ensure its unique.\n      @removeSubview name\n      subviews.push view\n      byName[name] = view\n      view\n    else if name\n      # Get and return the subview by the given name.\n      byName[name]\n\n  # Removing a subview.\n  removeSubview: (nameOrView) ->\n    return unless nameOrView\n    subviews = @subviews\n    byName = @subviewsByName\n\n    if typeof nameOrView is 'string'\n      # Name given, search for a subview by name.\n      name = nameOrView\n      view = byName[name]\n    else\n      # View instance given, search for the corresponding name.\n      view = nameOrView\n      for otherName, otherView of byName when otherView is view\n        name = otherName\n        break\n\n    # Break if no view and name were found.\n    return unless name and view and view.dispose\n\n    # Dispose the view.\n    view.dispose()\n\n    # Remove the subview from the lists.\n    index = subviews.indexOf view\n    subviews.splice index, 1 if index isnt -1\n    delete byName[name]\n\n  # Rendering\n  # ---------\n\n  # Get the model/collection data for the templating function\n  # Uses optimized Chaplin serialization if available.\n  getTemplateData: ->\n    data = if @model\n      utils.serialize @model\n    else if @collection\n      {items: utils.serialize(@collection), length: @collection.length}\n    else\n      {}\n\n    source = @model or @collection\n    if source\n      # If the model/collection is a SyncMachine, add a `synced` flag,\n      # but only if its not present yet.\n      if typeof source.isSynced is 'function' and not ('synced' of data)\n        data.synced = source.isSynced()\n\n    data\n\n  # Returns the compiled template function.\n  getTemplateFunction: ->\n    # Chaplin doesnt define how you load and compile templates in order to\n    # render views. The example application uses Handlebars and RequireJS\n    # to load and compile templates on the client side. See the derived\n    # View class in the\n    # [example application](https://github.com/chaplinjs/facebook-example).\n    #\n    # If you precompile templates to JavaScript functions on the server,\n    # you might just return a reference to that function.\n    # Several precompilers create a global `JST` hash which stores the\n    # template functions. You can get the function by the template name:\n    # JST[@templateName]\n    throw new Error 'View#getTemplateFunction must be overridden'\n\n  # Main render function.\n  # This method is bound to the instance in the constructor (see above)\n  render: ->\n    # Do not render if the object was disposed\n    # (render might be called as an event handler which wasnt\n    # removed correctly).\n    return false if @disposed\n\n    templateFunc = @getTemplateFunction()\n\n    if typeof templateFunc is 'function'\n      # Call the template function passing the template data.\n      html = templateFunc @getTemplateData()\n\n      # Replace HTML\n      if @noWrap\n        el = document.createElement 'div'\n        el.innerHTML = html\n\n        if el.children.length > 1\n          throw new Error 'There must be a single top-level element when ' +\n                          'using `noWrap`.'\n\n        # Undelegate the container events that were setup.\n        @undelegateEvents()\n        # Delegate events to the top-level container in the template.\n        @setElement el.firstChild, true\n      else\n        setHTML (if $ then @$el else @el), html\n\n    # Return the view.\n    this\n\n  # This method is called after a specific `render` of a derived class.\n  attach: ->\n    # Attempt to bind this view to its named region.\n    mediator.execute 'region:show', @region, this if @region?\n\n    # Automatically append to DOM if the container element is set.\n    if @container and not document.body.contains @el\n      attach this\n      # Trigger an event.\n      @trigger 'addedToDOM'\n\n  # Disposal\n  # --------\n\n  disposed: false\n\n  dispose: ->\n    return if @disposed\n\n    # Dispose subviews.\n    subview.dispose() for subview in @subviews\n\n    # Unbind handlers of global events.\n    @unsubscribeAllEvents()\n\n    # Remove all event handlers on this module.\n    @off()\n\n    # Check if view should be removed from DOM.\n    if @keepElement\n      # Unsubscribe from all DOM events.\n      @undelegateEvents()\n      @undelegate()\n      # Unbind all referenced handlers.\n      @stopListening()\n    else\n      # Remove the topmost element from DOM. This also removes all event\n      # handlers from the element and all its children.\n      @remove()\n\n    # Remove element references, options,\n    # model/collection references and subview lists.\n    properties = [\n      'el', '$el',\n      'options', 'model', 'collection',\n      'subviews', 'subviewsByName',\n      '_callbacks'\n    ]\n    delete this[prop] for prop in properties\n\n    # Finished.\n    @disposed = true\n\n    # Youre frozen when your hearts not open.\n    Object.freeze? this\n\n  getTemplateFunction: ->\n    @template\n"]}